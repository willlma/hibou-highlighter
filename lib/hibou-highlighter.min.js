!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("highlighter",[],t):"object"==typeof exports?exports.highlighter=t():e.highlighter=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);Object.defineProperty(t,"changeSelectedHighlight",{enumerable:!0,get:function(){return o.changeSelectedHighlight}}),Object.defineProperty(t,"showScrollIndicator",{enumerable:!0,get:function(){return o.showScrollIndicator}}),Object.defineProperty(t,"scrollToHighlight",{enumerable:!0,get:function(){return o.scrollToHighlight}});var i=n(3);Object.defineProperty(t,"highlight",{enumerable:!0,get:function(){return i.highlight}}),Object.defineProperty(t,"highlightRange",{enumerable:!0,get:function(){return i.highlightRange}});var a=n(7);Object.defineProperty(t,"removeHylytElems",{enumerable:!0,get:function(){return r(a).default}});var l=n(8);Object.defineProperty(t,"restore",{enumerable:!0,get:function(){return r(l).default}})},function(e,t,n){"use strict";function r(e){for(var t=e.length;t--;)e[t].classList.toggle("hi-selected")}function o(){var e=document.querySelector(".hi-scroll-indicator.active");e&&e.classList.remove("active")}function i(e){return document.querySelector((0,f.getIndicatorSelector)(e.id))}function a(e,t){e&&r(e.elems),o(),t&&(g(t),e!==t&&r(t.elems),i(t).classList.add("active"))}function l(e){return(e[0].getBoundingClientRect().top+e[e.length-1].getBoundingClientRect().bottom)/2+window.scrollY}function c(e,t){var n=document.createElement("div");return n.className=(0,f.getIndicatorClassName)(e.id),document.body.appendChild(n),n.addEventListener("click",function(n){window.scrollTo(0,(l(e.elems)-window.innerHeight)/2),t&&t(e,n)}),n}function d(e,t){var n=l(e.elems),r=n/document.documentElement.scrollHeight*window.innerHeight;t||(t=i(e)),t.style.top=r-10+"px"}function u(e,t){var n=c(e,t);d(e,n)}function s(e){var t=l(e.elems);window.scrollTo((t-window.innerHeight)/2)}Object.defineProperty(t,"__esModule",{value:!0}),t.changeSelectedHighlight=a,t.placeScrollIndicator=d,t.addScrollIndicator=u,t.scrollToHighlight=s;var f=n(2),g=function(e){return setTimeout(function(){if(e&&e.elems&&e.elems.length){var t=document.getSelection();if(t){t.removeAllRanges();var n=document.createRange();n.setStartBefore(e.elems[0]),n.setEndAfter(e.elems[e.elems.length-1]),t.addRange(n)}}})}},function(e,t){"use strict";function n(e){return"hi-scroll-indicator hi-"+e}function r(e){return".hi-scroll-indicator.hi-"+e}Object.defineProperty(t,"__esModule",{value:!0}),t.getIndicatorClassName=n,t.getIndicatorSelector=r;t.tagName="hylyt",t.rangeNotTextNodeError="Range start or end is not a text node.",t.nodeWithoutParent="Can't replace node. Doesn't have a parent"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e.commonAncestorContainer.parentElement||document.body).cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}function i(e){var t=e.startContainer,n=e.endContainer;return t instanceof Text&&n instanceof Text&&t.parentElement&&t.parentElement.localName!==m.tagName&&n.parentElement&&n.parentElement.localName!==m.tagName}function a(e,t,n){if(!i(t))return null;var r=t.startContainer,a=t.endContainer,l=(0,d.getLocation)(r),c=(0,d.getLocation)(a),u={id:e,html:o(t),startSelector:(0,s.default)(r),startNodeIndex:l.index,startOffset:t.startOffset+l.offset,endSelector:(0,s.default)(a),endNodeIndex:c.index,endOffset:t.endOffset+c.offset,deleted:!1,elems:(0,g.default)(t,function(e){return n&&n(u,e)})};return u}function l(e,t,n){var r=0,o=e.getRangeAt(0),l=o.startOffset,c=o.startContainer,d=o.endContainer;if(o.collapsed||!i(o)||c===d&&o.endOffset-l<3)return null;o.commonAncestorContainer.normalize();for(var u=e.rangeCount-1;r<u&&o.endContainer.nodeType!==Node.TEXT_NODE;r++){var s=e.getRangeAt(r);o.setEnd(s.endContainer,s.endOffset)}for(var f=/[^\w']/g,g=0;f.lastIndex<=l&&(g=f.lastIndex,f.exec(o.startContainer.textContent)););o.setStart(o.startContainer,g),f.lastIndex=0;var m=o.endContainer.textContent.substr(o.endOffset);g=m.search(f),g===-1&&(g=m.length),o.setEnd(o.endContainer,o.endOffset+g);var v=a(t,o,n);return v?((0,h.addScrollIndicator)(v,n),n&&n(v),v):null}function c(e,t){var n=getSelection();return n&&!n.isCollapsed?l(n,e,t):null}Object.defineProperty(t,"__esModule",{value:!0}),t.isValidRange=i,t.highlightRange=a,t.highlight=c;var d=n(4),u=n(5),s=r(u),f=n(6),g=r(f),h=n(1),m=n(2)},function(e,t){"use strict";function n(e){var t=e.parentNode||document.body,n=[].indexOf.call(t.childNodes,e),r=o.get(t);if(!r)return{index:n,offset:0};for(var i in r){i*=1;var a=r[i];if(i>n)break;if(n>=a.length+i)n-=a.length;else if(n>i)return{index:i,offset:a[n-i-1]};if(i===n){var l=a.length;return{index:n,offset:l?a[l-1]:0}}}return{index:n,offset:0}}function r(e,t){if(!t||t===e.data.length)return e;var r={node:e},i=e.splitText(t),a=n(e),l=o.get(r);return l||(l=[],o.set(r,l)),l[a.index]||(l[a.index]=[]),l[a.index].push(a.offset+t),l[a.index].sort(function(e,t){return e-t}),i}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocation=n,t.splitText=r;var o=new WeakMap},function(e,t){"use strict";function n(e){e.nodeType===Node.TEXT_NODE&&(e=e.parentNode);var t=e.ownerDocument;if(e.id&&t.getElementById(e.id)===e)return"#"+e.id;var o=e.tagName.toLowerCase();if("html"===o||"head"===o||"body"===o)return o;e.parentNode||console.warn("danger: "+o);var i,a=function(e){try{if(1===t.querySelectorAll(e).length)return!0}catch(e){}return!1};if(e.classList.length>0)for(var l=0;l<e.classList.length;l++){if(i="."+e.classList.item(l),a(i))return i;if(i=o+i,a(i))return i;if(i+=r(e),a(i))return i}return i=n(e.parentNode)+" > "+o+r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var r=function(e){for(var t=[].slice.call(e.parentNode.children),n=t.length;n--;)t[n].localName!==e.localName&&[].splice.call(t,n,1);var r=[].indexOf.call(t,e)+1;return":nth-of-type("+r+")"};e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=document.createElement(a.tagName);t.textContent=e.textContent;var n=e.parentNode;if(!n)throw new Error(a.nodeWithoutParent);return n.replaceChild(t,e),t}function o(e){return!/\S/.test(e.textContent)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.startOffset,l=e.startContainer,c=e.endContainer,d=e.endOffset;if(!(l instanceof Text&&c instanceof Text))throw new Error(a.rangeNotTextNodeError);(0,i.splitText)(c,d),e.setStart((0,i.splitText)(l,n),0);for(var u,s=document.createNodeIterator(e.commonAncestorContainer,NodeFilter.SHOW_TEXT,function(t){return e.intersectsNode(t)&&!o(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}),f=[],g=1e3;g--&&(u=s.nextNode());)f.push(u);return f.map(function(e){var n=r(e);return n.addEventListener("click",t),n})};var i=n(4),a=n(2);e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.elems.forEach(function(e){var t=document.createTextNode(e.textContent);e.parentNode.replaceChild(t,e)}),(0,r.getScrollIndicator)(e).remove()};var r=n(1);e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return document.querySelector(e).childNodes[t]}function i(e){var t=document.createRange(),n=void 0,r=void 0;return e.elems?(t.setStartBefore(e.elems[0]),t.setEndAfter(e.elems[e.elems.length-1])):(n=o(e.startSelector,e.startNodeIndex),r=o(e.endSelector,e.endNodeIndex),t.setStart(n,e.startOffset),t.setEnd(r,e.endOffset)),t}function a(e){e.forEach(function(e){return(0,l.placeScrollIndicator)(e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(e){var n=i(e);(0,u.isValidRange)(n)&&(e.elems=(0,d.default)(n,function(n){return t&&t(e,n)}))});var n="#hi-";e.forEach(function(e){return(0,l.addScrollIndicator)(e,t)});var r=void 0;if(!location.hash.indexOf(n)){r=parseInt(location.hash.substr(n.length));var o=e.find(function(e){return e.id===r});o&&(0,l.scrollToHighlight)(o)}return window.onload=function(){a(e)},r};var l=n(1),c=n(6),d=r(c),u=n(3);e.exports=t.default}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy9oaWJvdS1oaWdobGlnaHRlci5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDUzNjAwNTBhY2M2YTc3MDBhZTM3Iiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc2VsZWN0ZWQtaGlnaGxpZ2h0LmpzIiwid2VicGFjazovLy8uL3NyYy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2hpZ2hsaWdodC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZG9tLW11dGF0aW9uLmpzIiwid2VicGFjazovLy8uL3NyYy9nZXQtc2VsZWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NyZWF0ZS1lbGVtcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcmVtb3ZlLmpzIiwid2VicGFjazovLy8uL3NyYy9yZXN0b3JlLmpzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsInRoaXMiLCJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImlkIiwibG9hZGVkIiwiY2FsbCIsIm0iLCJjIiwicCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJfc2VsZWN0ZWRIaWdobGlnaHQiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiY2hhbmdlU2VsZWN0ZWRIaWdobGlnaHQiLCJzaG93U2Nyb2xsSW5kaWNhdG9yIiwic2Nyb2xsVG9IaWdobGlnaHQiLCJfaGlnaGxpZ2h0IiwiaGlnaGxpZ2h0IiwiaGlnaGxpZ2h0UmFuZ2UiLCJfcmVtb3ZlIiwiX3Jlc3RvcmUiLCJ0b2dnbGVTZWxlY3RlZENsYXNzIiwiZWxlbXMiLCJpIiwibGVuZ3RoIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiZGVhY3RpdmF0ZVNjcm9sbEluZGljYXRvciIsImFjdGl2ZVNjcm9sbEluZGljYXRvciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInJlbW92ZSIsImdldFNjcm9sbEluZGljYXRvciIsImh5bHl0IiwiX2NvbnN0YW50cyIsImdldEluZGljYXRvclNlbGVjdG9yIiwibGFzdEh5bHl0Iiwic2VsZWN0SGwiLCJhZGQiLCJnZXRUb3AiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJib3R0b20iLCJ3aW5kb3ciLCJzY3JvbGxZIiwiY3JlYXRlU2Nyb2xsSW5kaWNhdG9yIiwib25DbGljayIsImluZGljYXRvciIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJnZXRJbmRpY2F0b3JDbGFzc05hbWUiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0Iiwic2Nyb2xsVG8iLCJpbm5lckhlaWdodCIsInBsYWNlU2Nyb2xsSW5kaWNhdG9yIiwiZml4ZWRUb3AiLCJkb2N1bWVudEVsZW1lbnQiLCJzY3JvbGxIZWlnaHQiLCJzdHlsZSIsImFkZFNjcm9sbEluZGljYXRvciIsInNjcm9sbEluZGljYXRvciIsInNldFRpbWVvdXQiLCJzZWxlY3Rpb24iLCJnZXRTZWxlY3Rpb24iLCJyZW1vdmVBbGxSYW5nZXMiLCJyYW5nZSIsImNyZWF0ZVJhbmdlIiwic2V0U3RhcnRCZWZvcmUiLCJzZXRFbmRBZnRlciIsImFkZFJhbmdlIiwiaHlseXRJZCIsInRhZ05hbWUiLCJyYW5nZU5vdFRleHROb2RlRXJyb3IiLCJub2RlV2l0aG91dFBhcmVudCIsImdldFJhbmdlSHRtbCIsImNvbnRhaW5lciIsImNvbW1vbkFuY2VzdG9yQ29udGFpbmVyIiwicGFyZW50RWxlbWVudCIsImNsb25lTm9kZSIsImNsb25lQ29udGVudHMiLCJpbm5lckhUTUwiLCJpc1ZhbGlkUmFuZ2UiLCJzdGFydENvbnRhaW5lciIsImVuZENvbnRhaW5lciIsIlRleHQiLCJsb2NhbE5hbWUiLCJzdGFydExvY2F0aW9uIiwiX2RvbU11dGF0aW9uIiwiZ2V0TG9jYXRpb24iLCJlbmRMb2NhdGlvbiIsImh0bWwiLCJzdGFydFNlbGVjdG9yIiwiX2dldFNlbGVjdG9yMiIsInN0YXJ0Tm9kZUluZGV4IiwiaW5kZXgiLCJzdGFydE9mZnNldCIsIm9mZnNldCIsImVuZFNlbGVjdG9yIiwiZW5kTm9kZUluZGV4IiwiZW5kT2Zmc2V0IiwiZGVsZXRlZCIsIl9jcmVhdGVFbGVtczIiLCJoaWdobGlnaHRTZWxlY3Rpb24iLCJnZXRSYW5nZUF0IiwiY29sbGFwc2VkIiwibm9ybWFsaXplIiwibGVuIiwicmFuZ2VDb3VudCIsIm5vZGVUeXBlIiwiTm9kZSIsIlRFWFRfTk9ERSIsImN1cnJlbnRSYW5nZSIsInNldEVuZCIsInJlIiwibGFzdEluZGV4IiwiZXhlYyIsInRleHRDb250ZW50Iiwic2V0U3RhcnQiLCJwb3N0RW5kU3RyaW5nIiwic3Vic3RyIiwic2VhcmNoIiwiaXNDb2xsYXBzZWQiLCJfZ2V0U2VsZWN0b3IiLCJfY3JlYXRlRWxlbXMiLCJ0ZXh0Tm9kZSIsInBhcmVudCIsInBhcmVudE5vZGUiLCJub2RlSW5kZXgiLCJpbmRleE9mIiwiY2hpbGROb2RlcyIsImFmZmVjdGVkIiwiYWZmZWN0ZWRFbGVtcyIsInNwbGl0cyIsInNwbGl0VGV4dCIsIm5vZGUiLCJkYXRhIiwibmV3Tm9kZSIsImxvY2F0aW9uIiwic2V0IiwicHVzaCIsInNvcnQiLCJhIiwiYiIsIldlYWtNYXAiLCJnZXRTZWxlY3RvciIsImVsZSIsIm93bmVyRG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInRvTG93ZXJDYXNlIiwiY29uc29sZSIsIndhcm4iLCJzZWxlY3RvciIsImlzVW5pcXVlIiwicXVlcnlTZWxlY3RvckFsbCIsImUiLCJpdGVtIiwiZ2V0TnRoT2ZUeXBlIiwiZWxlbSIsInNpYmxpbmdzIiwic2xpY2UiLCJjaGlsZHJlbiIsInNwbGljZSIsInJlcGxhY2UiLCJzcGFuIiwiRXJyb3IiLCJyZXBsYWNlQ2hpbGQiLCJpc0VtcHR5IiwidGVzdCIsImN1cnJlbnROb2RlIiwibm9kZUl0ZXJhdG9yIiwiY3JlYXRlTm9kZUl0ZXJhdG9yIiwiTm9kZUZpbHRlciIsIlNIT1dfVEVYVCIsImludGVyc2VjdHNOb2RlIiwiRklMVEVSX0FDQ0VQVCIsIkZJTFRFUl9SRUpFQ1QiLCJoeWx5dEVsZW1zIiwibmV4dE5vZGUiLCJtYXAiLCJoeWx5dEVsZW0iLCJmb3JFYWNoIiwiY3JlYXRlVGV4dE5vZGUiLCJnZXRUZXh0Tm9kZSIsInBhcmVudFNlbGVjdG9yIiwiZ2V0SHlseXRSYW5nZSIsInN0YXJ0Tm9kZSIsImVuZE5vZGUiLCJwbGFjZUluZGljYXRvcnMiLCJoeWx5dHMiLCJobCIsIkFycmF5IiwiaXNBcnJheSIsImhhc2hTdGFydCIsImhhc2giLCJwYXJzZUludCIsImZpbmQiLCJvbmxvYWQiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBQ0EsZ0JBQUFDLFVBQUEsZ0JBQUFDLFFBQ0FBLE9BQUFELFFBQUFELElBQ0Esa0JBQUFHLGdCQUFBQyxJQUNBRCxPQUFBLGlCQUFBSCxHQUNBLGdCQUFBQyxTQUNBQSxRQUFBLFlBQUFELElBRUFELEVBQUEsWUFBQUMsS0FDQ0ssS0FBQSxXQUNELE1DQWdCLFVBQVVDLEdDTjFCLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBUCxPQUdBLElBQUFDLEdBQUFPLEVBQUFELElBQ0FQLFdBQ0FTLEdBQUFGLEVBQ0FHLFFBQUEsRUFVQSxPQU5BTCxHQUFBRSxHQUFBSSxLQUFBVixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBTSxHQUdBTCxFQUFBUyxRQUFBLEVBR0FULEVBQUFELFFBdkJBLEdBQUFRLEtBcUNBLE9BVEFGLEdBQUFNLEVBQUFQLEVBR0FDLEVBQUFPLEVBQUFMLEVBR0FGLEVBQUFRLEVBQUEsR0FHQVIsRUFBQSxLRGdCTSxTQUFTTCxFQUFRRCxFQUFTTSxHQUUvQixZQTRE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SUFBQS9ELEdBQUFoQixFQUFBLEdBQ0FvSSxFQUFBcEksRUFBQSxHVndsQks4RyxFQUFnQnJHLEVBQXVCMkgsR1V2bEI1QzlHLEVBQUF0QixFQUFBLEVWd25CQ0wsR0FBT0QsUUFBVUEsRUFBaUIiLCJmaWxlIjoiaGlib3UtaGlnaGxpZ2h0ZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJoaWdobGlnaHRlclwiLCBbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJoaWdobGlnaHRlclwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJoaWdobGlnaHRlclwiXSA9IGZhY3RvcnkoKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIFxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShcImhpZ2hsaWdodGVyXCIsIFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcImhpZ2hsaWdodGVyXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcImhpZ2hsaWdodGVyXCJdID0gZmFjdG9yeSgpO1xufSkodGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXG4vKioqKioqLyBcdFx0XHRpZDogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfc2VsZWN0ZWRIaWdobGlnaHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdjaGFuZ2VTZWxlY3RlZEhpZ2hsaWdodCcsIHtcblx0ICBlbnVtZXJhYmxlOiB0cnVlLFxuXHQgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHQgICAgcmV0dXJuIF9zZWxlY3RlZEhpZ2hsaWdodC5jaGFuZ2VTZWxlY3RlZEhpZ2hsaWdodDtcblx0ICB9XG5cdH0pO1xuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ3Nob3dTY3JvbGxJbmRpY2F0b3InLCB7XG5cdCAgZW51bWVyYWJsZTogdHJ1ZSxcblx0ICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgIHJldHVybiBfc2VsZWN0ZWRIaWdobGlnaHQuc2hvd1Njcm9sbEluZGljYXRvcjtcblx0ICB9XG5cdH0pO1xuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ3Njcm9sbFRvSGlnaGxpZ2h0Jywge1xuXHQgIGVudW1lcmFibGU6IHRydWUsXG5cdCAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cdCAgICByZXR1cm4gX3NlbGVjdGVkSGlnaGxpZ2h0LnNjcm9sbFRvSGlnaGxpZ2h0O1xuXHQgIH1cblx0fSk7XG5cdFxuXHR2YXIgX2hpZ2hsaWdodCA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ2hpZ2hsaWdodCcsIHtcblx0ICBlbnVtZXJhYmxlOiB0cnVlLFxuXHQgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHQgICAgcmV0dXJuIF9oaWdobGlnaHQuaGlnaGxpZ2h0O1xuXHQgIH1cblx0fSk7XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnaGlnaGxpZ2h0UmFuZ2UnLCB7XG5cdCAgZW51bWVyYWJsZTogdHJ1ZSxcblx0ICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgIHJldHVybiBfaGlnaGxpZ2h0LmhpZ2hsaWdodFJhbmdlO1xuXHQgIH1cblx0fSk7XG5cdFxuXHR2YXIgX3JlbW92ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ3JlbW92ZUh5bHl0RWxlbXMnLCB7XG5cdCAgZW51bWVyYWJsZTogdHJ1ZSxcblx0ICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgIHJldHVybiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW1vdmUpLmRlZmF1bHQ7XG5cdCAgfVxuXHR9KTtcblx0XG5cdHZhciBfcmVzdG9yZSA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ3Jlc3RvcmUnLCB7XG5cdCAgZW51bWVyYWJsZTogdHJ1ZSxcblx0ICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgIHJldHVybiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZXN0b3JlKS5kZWZhdWx0O1xuXHQgIH1cblx0fSk7XG5cblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLmNoYW5nZVNlbGVjdGVkSGlnaGxpZ2h0ID0gY2hhbmdlU2VsZWN0ZWRIaWdobGlnaHQ7XG5cdGV4cG9ydHMucGxhY2VTY3JvbGxJbmRpY2F0b3IgPSBwbGFjZVNjcm9sbEluZGljYXRvcjtcblx0ZXhwb3J0cy5hZGRTY3JvbGxJbmRpY2F0b3IgPSBhZGRTY3JvbGxJbmRpY2F0b3I7XG5cdGV4cG9ydHMuc2Nyb2xsVG9IaWdobGlnaHQgPSBzY3JvbGxUb0hpZ2hsaWdodDtcblx0XG5cdHZhciBfY29uc3RhbnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0XG5cdGZ1bmN0aW9uIHRvZ2dsZVNlbGVjdGVkQ2xhc3MoZWxlbXMpIHtcblx0ICBmb3IgKHZhciBpID0gZWxlbXMubGVuZ3RoOyBpLS07KSB7XG5cdCAgICBlbGVtc1tpXS5jbGFzc0xpc3QudG9nZ2xlKCdoaS1zZWxlY3RlZCcpO1xuXHQgIH1cblx0fVxuXHRcblx0XG5cdHZhciBzZWxlY3RIbCA9IGZ1bmN0aW9uIHNlbGVjdEhsKGh5bHl0KSB7XG5cdCAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKCEoaHlseXQgJiYgaHlseXQuZWxlbXMgJiYgaHlseXQuZWxlbXMubGVuZ3RoKSkgcmV0dXJuO1xuXHQgICAgdmFyIHNlbGVjdGlvbiA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpO1xuXHQgICAgaWYgKCFzZWxlY3Rpb24pIHJldHVybjtcblx0ICAgIHNlbGVjdGlvbi5yZW1vdmVBbGxSYW5nZXMoKTtcblx0ICAgIHZhciByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XG5cdCAgICByYW5nZS5zZXRTdGFydEJlZm9yZShoeWx5dC5lbGVtc1swXSk7XG5cdCAgICByYW5nZS5zZXRFbmRBZnRlcihoeWx5dC5lbGVtc1toeWx5dC5lbGVtcy5sZW5ndGggLSAxXSk7XG5cdCAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xuXHQgIH0pO1xuXHR9O1xuXHRcblx0ZnVuY3Rpb24gZGVhY3RpdmF0ZVNjcm9sbEluZGljYXRvcigpIHtcblx0ICB2YXIgYWN0aXZlU2Nyb2xsSW5kaWNhdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhpLXNjcm9sbC1pbmRpY2F0b3IuYWN0aXZlJyk7XG5cdCAgaWYgKGFjdGl2ZVNjcm9sbEluZGljYXRvcikgYWN0aXZlU2Nyb2xsSW5kaWNhdG9yLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBnZXRTY3JvbGxJbmRpY2F0b3IoaHlseXQpIHtcblx0ICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigoMCwgX2NvbnN0YW50cy5nZXRJbmRpY2F0b3JTZWxlY3RvcikoaHlseXQuaWQpKTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gY2hhbmdlU2VsZWN0ZWRIaWdobGlnaHQobGFzdEh5bHl0LCBoeWx5dCkge1xuXHQgIGlmIChsYXN0SHlseXQpIHRvZ2dsZVNlbGVjdGVkQ2xhc3MobGFzdEh5bHl0LmVsZW1zKTtcblx0ICBkZWFjdGl2YXRlU2Nyb2xsSW5kaWNhdG9yKCk7XG5cdCAgaWYgKGh5bHl0KSB7XG5cdCAgICBzZWxlY3RIbChoeWx5dCk7XG5cdCAgICBpZiAobGFzdEh5bHl0ICE9PSBoeWx5dCkgdG9nZ2xlU2VsZWN0ZWRDbGFzcyhoeWx5dC5lbGVtcyk7XG5cdCAgICBnZXRTY3JvbGxJbmRpY2F0b3IoaHlseXQpLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuXHQgIH1cblx0fVxuXHRcblx0ZnVuY3Rpb24gZ2V0VG9wKGVsZW1zKSB7XG5cdCAgcmV0dXJuIChlbGVtc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyBlbGVtc1tlbGVtcy5sZW5ndGggLSAxXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b20pIC8gMiArIHdpbmRvdy5zY3JvbGxZO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBjcmVhdGVTY3JvbGxJbmRpY2F0b3IoaHlseXQsIG9uQ2xpY2spIHtcblx0ICB2YXIgaW5kaWNhdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdCAgaW5kaWNhdG9yLmNsYXNzTmFtZSA9ICgwLCBfY29uc3RhbnRzLmdldEluZGljYXRvckNsYXNzTmFtZSkoaHlseXQuaWQpO1xuXHQgIC8vIGluZGljYXRvci5ocmVmID0gJyNoaS0nICsgaHlseXQuaWQ7XG5cdCAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpbmRpY2F0b3IpO1xuXHQgIGluZGljYXRvci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldnQpIHtcblx0ICAgIHdpbmRvdy5zY3JvbGxUbygwLCAoZ2V0VG9wKGh5bHl0LmVsZW1zKSAtIHdpbmRvdy5pbm5lckhlaWdodCkgLyAyKTtcblx0ICAgIGlmIChvbkNsaWNrKSBvbkNsaWNrKGh5bHl0LCBldnQpO1xuXHQgIH0pO1xuXHQgIHJldHVybiBpbmRpY2F0b3I7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHBsYWNlU2Nyb2xsSW5kaWNhdG9yKGh5bHl0LCBpbmRpY2F0b3IpIHtcblx0ICB2YXIgdG9wID0gZ2V0VG9wKGh5bHl0LmVsZW1zKTtcblx0ICB2YXIgZml4ZWRUb3AgPSB0b3AgLyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0ICogd2luZG93LmlubmVySGVpZ2h0O1xuXHQgIGlmICghaW5kaWNhdG9yKSBpbmRpY2F0b3IgPSBnZXRTY3JvbGxJbmRpY2F0b3IoaHlseXQpO1xuXHQgIGluZGljYXRvci5zdHlsZS50b3AgPSBmaXhlZFRvcCAtIDEwICsgJ3B4Jztcblx0fVxuXHRcblx0ZnVuY3Rpb24gYWRkU2Nyb2xsSW5kaWNhdG9yKGh5bHl0LCBvbkNsaWNrKSB7XG5cdCAgdmFyIHNjcm9sbEluZGljYXRvciA9IGNyZWF0ZVNjcm9sbEluZGljYXRvcihoeWx5dCwgb25DbGljayk7XG5cdCAgcGxhY2VTY3JvbGxJbmRpY2F0b3IoaHlseXQsIHNjcm9sbEluZGljYXRvcik7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHNjcm9sbFRvSGlnaGxpZ2h0KGh5bHl0KSB7XG5cdCAgdmFyIHRvcCA9IGdldFRvcChoeWx5dC5lbGVtcyk7XG5cdCAgd2luZG93LnNjcm9sbFRvKCh0b3AgLSB3aW5kb3cuaW5uZXJIZWlnaHQpIC8gMik7XG5cdH1cblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLmdldEluZGljYXRvckNsYXNzTmFtZSA9IGdldEluZGljYXRvckNsYXNzTmFtZTtcblx0ZXhwb3J0cy5nZXRJbmRpY2F0b3JTZWxlY3RvciA9IGdldEluZGljYXRvclNlbGVjdG9yO1xuXHRmdW5jdGlvbiBnZXRJbmRpY2F0b3JDbGFzc05hbWUoaHlseXRJZCkge1xuXHQgIHJldHVybiAnaGktc2Nyb2xsLWluZGljYXRvciBoaS0nICsgaHlseXRJZDtcblx0fVxuXHRcblx0ZnVuY3Rpb24gZ2V0SW5kaWNhdG9yU2VsZWN0b3IoaHlseXRJZCkge1xuXHQgIHJldHVybiAnLmhpLXNjcm9sbC1pbmRpY2F0b3IuaGktJyArIGh5bHl0SWQ7XG5cdH1cblx0XG5cdHZhciB0YWdOYW1lID0gZXhwb3J0cy50YWdOYW1lID0gJ2h5bHl0Jztcblx0dmFyIHJhbmdlTm90VGV4dE5vZGVFcnJvciA9IGV4cG9ydHMucmFuZ2VOb3RUZXh0Tm9kZUVycm9yID0gJ1JhbmdlIHN0YXJ0IG9yIGVuZCBpcyBub3QgYSB0ZXh0IG5vZGUuJztcblx0dmFyIG5vZGVXaXRob3V0UGFyZW50ID0gZXhwb3J0cy5ub2RlV2l0aG91dFBhcmVudCA9IFwiQ2FuJ3QgcmVwbGFjZSBub2RlLiBEb2Vzbid0IGhhdmUgYSBwYXJlbnRcIjtcblxuLyoqKi8gfSxcbi8qIDMgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLmlzVmFsaWRSYW5nZSA9IGlzVmFsaWRSYW5nZTtcblx0ZXhwb3J0cy5oaWdobGlnaHRSYW5nZSA9IGhpZ2hsaWdodFJhbmdlO1xuXHRleHBvcnRzLmhpZ2hsaWdodCA9IGhpZ2hsaWdodDtcblx0XG5cdHZhciBfZG9tTXV0YXRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXHRcblx0dmFyIF9nZXRTZWxlY3RvciA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG5cdFxuXHR2YXIgX2dldFNlbGVjdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFNlbGVjdG9yKTtcblx0XG5cdHZhciBfY3JlYXRlRWxlbXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpO1xuXHRcblx0dmFyIF9jcmVhdGVFbGVtczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVFbGVtcyk7XG5cdFxuXHR2YXIgX3NlbGVjdGVkSGlnaGxpZ2h0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfY29uc3RhbnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBnZXRSYW5nZUh0bWwocmFuZ2UpIHtcblx0ICB2YXIgY29udGFpbmVyID0gKHJhbmdlLmNvbW1vbkFuY2VzdG9yQ29udGFpbmVyLnBhcmVudEVsZW1lbnQgfHwgZG9jdW1lbnQuYm9keSkuY2xvbmVOb2RlKGZhbHNlKTtcblx0ICBjb250YWluZXIuYXBwZW5kQ2hpbGQocmFuZ2UuY2xvbmVDb250ZW50cygpKTtcblx0ICByZXR1cm4gY29udGFpbmVyLmlubmVySFRNTDtcblx0fVxuXHRmdW5jdGlvbiBpc1ZhbGlkUmFuZ2UocmFuZ2UpIHtcblx0ICB2YXIgc3RhcnRDb250YWluZXIgPSByYW5nZS5zdGFydENvbnRhaW5lcixcblx0ICAgICAgZW5kQ29udGFpbmVyID0gcmFuZ2UuZW5kQ29udGFpbmVyO1xuXHRcblx0ICByZXR1cm4gc3RhcnRDb250YWluZXIgaW5zdGFuY2VvZiBUZXh0ICYmIGVuZENvbnRhaW5lciBpbnN0YW5jZW9mIFRleHQgJiYgc3RhcnRDb250YWluZXIucGFyZW50RWxlbWVudCAmJiBzdGFydENvbnRhaW5lci5wYXJlbnRFbGVtZW50LmxvY2FsTmFtZSAhPT0gX2NvbnN0YW50cy50YWdOYW1lICYmIGVuZENvbnRhaW5lci5wYXJlbnRFbGVtZW50ICYmIGVuZENvbnRhaW5lci5wYXJlbnRFbGVtZW50LmxvY2FsTmFtZSAhPT0gX2NvbnN0YW50cy50YWdOYW1lO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBoaWdobGlnaHRSYW5nZShpZCwgcmFuZ2UsIG9uQ2xpY2spIHtcblx0ICBpZiAoIWlzVmFsaWRSYW5nZShyYW5nZSkpIHJldHVybiBudWxsO1xuXHQgIHZhciBzdGFydENvbnRhaW5lciA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyLFxuXHQgICAgICBlbmRDb250YWluZXIgPSByYW5nZS5lbmRDb250YWluZXI7XG5cdFxuXHQgIHZhciBzdGFydExvY2F0aW9uID0gKDAsIF9kb21NdXRhdGlvbi5nZXRMb2NhdGlvbikoc3RhcnRDb250YWluZXIpO1xuXHQgIHZhciBlbmRMb2NhdGlvbiA9ICgwLCBfZG9tTXV0YXRpb24uZ2V0TG9jYXRpb24pKGVuZENvbnRhaW5lcik7XG5cdCAgdmFyIGh5bHl0ID0ge1xuXHQgICAgaWQ6IGlkLFxuXHQgICAgaHRtbDogZ2V0UmFuZ2VIdG1sKHJhbmdlKSxcblx0ICAgIHN0YXJ0U2VsZWN0b3I6ICgwLCBfZ2V0U2VsZWN0b3IyLmRlZmF1bHQpKHN0YXJ0Q29udGFpbmVyKSxcblx0ICAgIHN0YXJ0Tm9kZUluZGV4OiBzdGFydExvY2F0aW9uLmluZGV4LFxuXHQgICAgc3RhcnRPZmZzZXQ6IHJhbmdlLnN0YXJ0T2Zmc2V0ICsgc3RhcnRMb2NhdGlvbi5vZmZzZXQsXG5cdCAgICBlbmRTZWxlY3RvcjogKDAsIF9nZXRTZWxlY3RvcjIuZGVmYXVsdCkoZW5kQ29udGFpbmVyKSxcblx0ICAgIGVuZE5vZGVJbmRleDogZW5kTG9jYXRpb24uaW5kZXgsXG5cdCAgICBlbmRPZmZzZXQ6IHJhbmdlLmVuZE9mZnNldCArIGVuZExvY2F0aW9uLm9mZnNldCxcblx0ICAgIGRlbGV0ZWQ6IGZhbHNlLFxuXHQgICAgZWxlbXM6ICgwLCBfY3JlYXRlRWxlbXMyLmRlZmF1bHQpKHJhbmdlLCBmdW5jdGlvbiAoZXZ0KSB7XG5cdCAgICAgIHJldHVybiBvbkNsaWNrICYmIG9uQ2xpY2soaHlseXQsIGV2dCk7XG5cdCAgICB9KVxuXHQgIH07XG5cdCAgcmV0dXJuIGh5bHl0O1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBoaWdobGlnaHRTZWxlY3Rpb24oc2VsZWN0aW9uLCBpZCwgb25DbGljaykge1xuXHQgIHZhciBpID0gMDtcblx0ICB2YXIgcmFuZ2UgPSBzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKTtcblx0ICB2YXIgc3RhcnRPZmZzZXQgPSByYW5nZS5zdGFydE9mZnNldCxcblx0ICAgICAgc3RhcnRDb250YWluZXIgPSByYW5nZS5zdGFydENvbnRhaW5lcixcblx0ICAgICAgZW5kQ29udGFpbmVyID0gcmFuZ2UuZW5kQ29udGFpbmVyO1xuXHRcblx0ICBpZiAocmFuZ2UuY29sbGFwc2VkIHx8ICFpc1ZhbGlkUmFuZ2UocmFuZ2UpIHx8IHN0YXJ0Q29udGFpbmVyID09PSBlbmRDb250YWluZXIgJiYgcmFuZ2UuZW5kT2Zmc2V0IC0gc3RhcnRPZmZzZXQgPCAzKSB7XG5cdCAgICByZXR1cm4gbnVsbDtcblx0ICB9XG5cdCAgcmFuZ2UuY29tbW9uQW5jZXN0b3JDb250YWluZXIubm9ybWFsaXplKCk7XG5cdCAgZm9yICh2YXIgbGVuID0gc2VsZWN0aW9uLnJhbmdlQ291bnQgLSAxOyBpIDwgbGVuICYmIHJhbmdlLmVuZENvbnRhaW5lci5ub2RlVHlwZSAhPT0gTm9kZS5URVhUX05PREU7IGkrKykge1xuXHQgICAgdmFyIGN1cnJlbnRSYW5nZSA9IHNlbGVjdGlvbi5nZXRSYW5nZUF0KGkpO1xuXHQgICAgcmFuZ2Uuc2V0RW5kKGN1cnJlbnRSYW5nZS5lbmRDb250YWluZXIsIGN1cnJlbnRSYW5nZS5lbmRPZmZzZXQpO1xuXHQgIH1cblx0ICB2YXIgcmUgPSAvW15cXHcnXS9nO1xuXHQgIC8vaWYgZG9pbmcgdW5pY29kZSByZWdpb25zOlxuXHQgIC8vIFtcXHdcXHUwMEMwLVxcdTAwRDZcXHUwMEQ4LVxcdTAwRjZcXHUwMEY4LVxcdTAxQkZcXHUwMUM0LVxcdTAyYjhdXG5cdCAgdmFyIGxhc3RJbmRleCA9IDA7XG5cdCAgd2hpbGUgKHJlLmxhc3RJbmRleCA8PSBzdGFydE9mZnNldCkge1xuXHQgICAgbGFzdEluZGV4ID0gcmUubGFzdEluZGV4O1xuXHQgICAgaWYgKCFyZS5leGVjKHJhbmdlLnN0YXJ0Q29udGFpbmVyLnRleHRDb250ZW50KSkgYnJlYWs7XG5cdCAgfVxuXHQgIHJhbmdlLnNldFN0YXJ0KHJhbmdlLnN0YXJ0Q29udGFpbmVyLCBsYXN0SW5kZXgpO1xuXHQgIHJlLmxhc3RJbmRleCA9IDA7XG5cdCAgdmFyIHBvc3RFbmRTdHJpbmcgPSByYW5nZS5lbmRDb250YWluZXIudGV4dENvbnRlbnQuc3Vic3RyKHJhbmdlLmVuZE9mZnNldCk7XG5cdCAgbGFzdEluZGV4ID0gcG9zdEVuZFN0cmluZy5zZWFyY2gocmUpO1xuXHQgIGlmIChsYXN0SW5kZXggPT09IC0xKSBsYXN0SW5kZXggPSBwb3N0RW5kU3RyaW5nLmxlbmd0aDtcblx0ICByYW5nZS5zZXRFbmQocmFuZ2UuZW5kQ29udGFpbmVyLCByYW5nZS5lbmRPZmZzZXQgKyBsYXN0SW5kZXgpO1xuXHRcblx0ICB2YXIgaHlseXQgPSBoaWdobGlnaHRSYW5nZShpZCwgcmFuZ2UsIG9uQ2xpY2spO1xuXHQgIGlmICghaHlseXQpIHJldHVybiBudWxsO1xuXHQgICgwLCBfc2VsZWN0ZWRIaWdobGlnaHQuYWRkU2Nyb2xsSW5kaWNhdG9yKShoeWx5dCwgb25DbGljayk7XG5cdCAgaWYgKG9uQ2xpY2spIG9uQ2xpY2soaHlseXQpO1xuXHQgIHJldHVybiBoeWx5dDtcblx0fVxuXHRcblx0ZnVuY3Rpb24gaGlnaGxpZ2h0KGlkLCBvbkNsaWNrKSB7XG5cdCAgLy8gSGlnaGxpZ2h0IGlmIHRleHQgc2VsZWN0ZWRcblx0ICB2YXIgc2VsZWN0aW9uID0gZ2V0U2VsZWN0aW9uKCk7XG5cdCAgaWYgKHNlbGVjdGlvbiAmJiAhc2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7XG5cdCAgICByZXR1cm4gaGlnaGxpZ2h0U2VsZWN0aW9uKHNlbGVjdGlvbiwgaWQsIG9uQ2xpY2spO1xuXHQgIH1cblx0ICByZXR1cm4gbnVsbDtcblx0fVxuXG4vKioqLyB9LFxuLyogNCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0ZXhwb3J0cy5nZXRMb2NhdGlvbiA9IGdldExvY2F0aW9uO1xuXHRleHBvcnRzLnNwbGl0VGV4dCA9IHNwbGl0VGV4dDtcblx0dmFyIGFmZmVjdGVkRWxlbXMgPSBuZXcgV2Vha01hcCgpO1xuXHRcblx0ZnVuY3Rpb24gZ2V0TG9jYXRpb24odGV4dE5vZGUpIHtcblx0ICB2YXIgcGFyZW50ID0gdGV4dE5vZGUucGFyZW50Tm9kZSB8fCBkb2N1bWVudC5ib2R5O1xuXHQgIHZhciBub2RlSW5kZXggPSBbXS5pbmRleE9mLmNhbGwocGFyZW50LmNoaWxkTm9kZXMsIHRleHROb2RlKTtcblx0ICB2YXIgYWZmZWN0ZWQgPSBhZmZlY3RlZEVsZW1zLmdldChwYXJlbnQpO1xuXHQgIGlmICghYWZmZWN0ZWQpIHJldHVybiB7XG5cdCAgICBpbmRleDogbm9kZUluZGV4LFxuXHQgICAgb2Zmc2V0OiAwXG5cdCAgfTtcblx0ICAvLyBsZWF2aW5nIGZvci4uLmluIHVudGlsIEkgY2FuIHRlc3Rcblx0ICBmb3IgKHZhciBfaW5kZXggaW4gYWZmZWN0ZWQpIHtcblx0ICAgIF9pbmRleCAqPSAxO1xuXHQgICAgdmFyIHNwbGl0cyA9IGFmZmVjdGVkW19pbmRleF07XG5cdCAgICBpZiAoX2luZGV4ID4gbm9kZUluZGV4KSBicmVhaztcblx0ICAgIGlmIChub2RlSW5kZXggPj0gc3BsaXRzLmxlbmd0aCArIF9pbmRleCkgbm9kZUluZGV4IC09IHNwbGl0cy5sZW5ndGg7ZWxzZSBpZiAobm9kZUluZGV4ID4gX2luZGV4KSByZXR1cm4ge1xuXHQgICAgICBpbmRleDogX2luZGV4LFxuXHQgICAgICBvZmZzZXQ6IHNwbGl0c1tub2RlSW5kZXggLSBfaW5kZXggLSAxXVxuXHQgICAgfTtcblx0ICAgIGlmIChfaW5kZXggPT09IG5vZGVJbmRleCkge1xuXHQgICAgICB2YXIgbGVuID0gc3BsaXRzLmxlbmd0aDtcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICBpbmRleDogbm9kZUluZGV4LFxuXHQgICAgICAgIG9mZnNldDogbGVuID8gc3BsaXRzW2xlbiAtIDFdIDogMFxuXHQgICAgICB9O1xuXHQgICAgfVxuXHQgIH1cblx0ICAvKmNvbnN0IGluZGV4ID0gYWZmZWN0ZWQuZmluZEluZGV4KChzcGxpdHMsIGk6IG51bWJlcikgPT4ge1xuXHQgICAgaWYgKGkgPiBub2RlSW5kZXgpIHJldHVybiBmYWxzZTtcblx0ICAgIGlmIChub2RlSW5kZXggPj0gc3BsaXRzLmxlbmd0aCArIGkpIG5vZGVJbmRleCAtPSBzcGxpdHMubGVuZ3RoO1xuXHQgICAgaWYgKG5vZGVJbmRleCA+PSBpKSByZXR1cm4gdHJ1ZTtcblx0ICAgIHJldHVybiBmYWxzZTtcblx0ICB9KTtcblx0ICAvLyBjYW4gdGhpcyBldnIgaGFwcGVuP1xuXHQgIGlmIChub2RlSW5kZXggPiBpbmRleCkqL1xuXHQgIHJldHVybiB7XG5cdCAgICBpbmRleDogbm9kZUluZGV4LFxuXHQgICAgb2Zmc2V0OiAwXG5cdCAgfTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gc3BsaXRUZXh0KG5vZGUsIG9mZnNldCkge1xuXHQgIGlmICghb2Zmc2V0IHx8IG9mZnNldCA9PT0gbm9kZS5kYXRhLmxlbmd0aCkgcmV0dXJuIG5vZGU7XG5cdCAgdmFyIHBhcmVudE5vZGUgPSB7IG5vZGU6IG5vZGUgfTtcblx0ICB2YXIgbmV3Tm9kZSA9IG5vZGUuc3BsaXRUZXh0KG9mZnNldCk7XG5cdCAgdmFyIGxvY2F0aW9uID0gZ2V0TG9jYXRpb24obm9kZSk7XG5cdCAgdmFyIGFmZmVjdGVkID0gYWZmZWN0ZWRFbGVtcy5nZXQocGFyZW50Tm9kZSk7XG5cdCAgaWYgKCFhZmZlY3RlZCkge1xuXHQgICAgYWZmZWN0ZWQgPSBbXTtcblx0ICAgIGFmZmVjdGVkRWxlbXMuc2V0KHBhcmVudE5vZGUsIGFmZmVjdGVkKTtcblx0ICB9XG5cdCAgaWYgKCFhZmZlY3RlZFtsb2NhdGlvbi5pbmRleF0pIGFmZmVjdGVkW2xvY2F0aW9uLmluZGV4XSA9IFtdO1xuXHQgIGFmZmVjdGVkW2xvY2F0aW9uLmluZGV4XS5wdXNoKGxvY2F0aW9uLm9mZnNldCArIG9mZnNldCk7XG5cdCAgYWZmZWN0ZWRbbG9jYXRpb24uaW5kZXhdLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcblx0ICAgIHJldHVybiBhIC0gYjtcblx0ICB9KTtcblx0ICByZXR1cm4gbmV3Tm9kZTtcblx0fVxuXG4vKioqLyB9LFxuLyogNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgdmFsdWU6IHRydWVcblx0fSk7XG5cdGV4cG9ydHMuZGVmYXVsdCA9IGdldFNlbGVjdG9yO1xuXHQvKipcblx0ICogRmluZCBhIHVuaXF1ZSBDU1Mgc2VsZWN0b3IgZm9yIGEgZ2l2ZW4gZWxlbWVudFxuXHQgKiBAcmV0dXJucyBhIHN0cmluZyBzdWNoIHRoYXQgZWxlLm93bmVyRG9jdW1lbnQucXVlcnlTZWxlY3RvcihyZXBseSkgPT09IGVsZVxuXHQgKiBhbmQgZWxlLm93bmVyRG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChyZXBseSkubGVuZ3RoID09PSAxXG5cdCAqL1xuXHRcblx0dmFyIGdldE50aE9mVHlwZSA9IGZ1bmN0aW9uIGdldE50aE9mVHlwZShlbGVtKSB7XG5cdCAgdmFyIHNpYmxpbmdzID0gW10uc2xpY2UuY2FsbChlbGVtLnBhcmVudE5vZGUuY2hpbGRyZW4pO1xuXHQgIGZvciAodmFyIGkgPSBzaWJsaW5ncy5sZW5ndGg7IGktLTspIHtcblx0ICAgIGlmIChzaWJsaW5nc1tpXS5sb2NhbE5hbWUgIT09IGVsZW0ubG9jYWxOYW1lKSBbXS5zcGxpY2UuY2FsbChzaWJsaW5ncywgaSwgMSk7XG5cdCAgfVxuXHQgIHZhciBpbmRleCA9IFtdLmluZGV4T2YuY2FsbChzaWJsaW5ncywgZWxlbSkgKyAxO1xuXHQgIHJldHVybiAnOm50aC1vZi10eXBlKCcgKyBpbmRleCArICcpJztcblx0fTtcblx0XG5cdGZ1bmN0aW9uIGdldFNlbGVjdG9yKGVsZSkge1xuXHQgIGlmIChlbGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSBlbGUgPSBlbGUucGFyZW50Tm9kZTtcblx0ICB2YXIgZG9jdW1lbnQgPSBlbGUub3duZXJEb2N1bWVudDtcblx0ICBpZiAoZWxlLmlkICYmIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZS5pZCkgPT09IGVsZSkge1xuXHQgICAgcmV0dXJuICcjJyArIGVsZS5pZDtcblx0ICB9XG5cdFxuXHQgIC8vIEluaGVyZW50bHkgdW5pcXVlIGJ5IHRhZyBuYW1lXG5cdCAgdmFyIHRhZ05hbWUgPSBlbGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuXHQgIGlmICh0YWdOYW1lID09PSAnaHRtbCcgfHwgdGFnTmFtZSA9PT0gJ2hlYWQnIHx8IHRhZ05hbWUgPT09ICdib2R5JykgcmV0dXJuIHRhZ05hbWU7XG5cdFxuXHQgIGlmICghZWxlLnBhcmVudE5vZGUpIGNvbnNvbGUud2FybignZGFuZ2VyOiAnICsgdGFnTmFtZSk7XG5cdFxuXHQgIC8vIFdlIG1pZ2h0IGJlIGFibGUgdG8gZmluZCBhIHVuaXF1ZSBjbGFzcyBuYW1lXG5cdCAgdmFyIGlzVW5pcXVlID0gZnVuY3Rpb24gaXNVbmlxdWUoc2VsZWN0b3IpIHtcblx0ICAgIHRyeSB7XG5cdCAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKS5sZW5ndGggPT09IDEpIHJldHVybiB0cnVlO1xuXHQgICAgfSBjYXRjaCAoZSkge31cblx0ICAgIHJldHVybiBmYWxzZTtcblx0ICB9O1xuXHRcblx0ICB2YXIgc2VsZWN0b3I7XG5cdCAgaWYgKGVsZS5jbGFzc0xpc3QubGVuZ3RoID4gMCkge1xuXHQgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGUuY2xhc3NMaXN0Lmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgIC8vIElzIHRoaXMgY2xhc3NOYW1lIHVuaXF1ZSBieSBpdHNlbGY/XG5cdCAgICAgIHNlbGVjdG9yID0gJy4nICsgZWxlLmNsYXNzTGlzdC5pdGVtKGkpO1xuXHQgICAgICBpZiAoaXNVbmlxdWUoc2VsZWN0b3IpKSByZXR1cm4gc2VsZWN0b3I7XG5cdCAgICAgIC8vIE1heWJlIGl0J3MgdW5pcXVlIHdpdGggYSB0YWcgbmFtZT9cblx0ICAgICAgc2VsZWN0b3IgPSB0YWdOYW1lICsgc2VsZWN0b3I7XG5cdCAgICAgIGlmIChpc1VuaXF1ZShzZWxlY3RvcikpIHJldHVybiBzZWxlY3Rvcjtcblx0ICAgICAgLy8gTWF5YmUgaXQncyB1bmlxdWUgdXNpbmcgYSB0YWcgbmFtZSBhbmQgbnRoLWNoaWxkXG5cdCAgICAgIHNlbGVjdG9yID0gc2VsZWN0b3IgKyBnZXROdGhPZlR5cGUoZWxlKTtcblx0ICAgICAgaWYgKGlzVW5pcXVlKHNlbGVjdG9yKSkgcmV0dXJuIHNlbGVjdG9yO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgLy8gU28gd2UgY2FuIGJlIHVuaXF1ZSB3LnIudC4gb3VyIHBhcmVudCwgYW5kIHVzZSByZWN1cnNpb25cblx0ICBzZWxlY3RvciA9IGdldFNlbGVjdG9yKGVsZS5wYXJlbnROb2RlKSArICcgPiAnICsgdGFnTmFtZSArIGdldE50aE9mVHlwZShlbGUpO1xuXHRcblx0ICByZXR1cm4gc2VsZWN0b3I7XG5cdH07XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogNiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHRleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAocmFuZ2UsIG9uQ2xpY2spIHtcblx0ICB2YXIgc3RhcnRPZmZzZXQgPSByYW5nZS5zdGFydE9mZnNldCxcblx0ICAgICAgc3RhcnRDb250YWluZXIgPSByYW5nZS5zdGFydENvbnRhaW5lcixcblx0ICAgICAgZW5kQ29udGFpbmVyID0gcmFuZ2UuZW5kQ29udGFpbmVyLFxuXHQgICAgICBlbmRPZmZzZXQgPSByYW5nZS5lbmRPZmZzZXQ7XG5cdFxuXHQgIGlmICghKHN0YXJ0Q29udGFpbmVyIGluc3RhbmNlb2YgVGV4dCAmJiBlbmRDb250YWluZXIgaW5zdGFuY2VvZiBUZXh0KSkge1xuXHQgICAgdGhyb3cgbmV3IEVycm9yKF9jb25zdGFudHMucmFuZ2VOb3RUZXh0Tm9kZUVycm9yKTtcblx0ICB9XG5cdCAgKDAsIF9kb21NdXRhdGlvbi5zcGxpdFRleHQpKGVuZENvbnRhaW5lciwgZW5kT2Zmc2V0KTtcblx0ICByYW5nZS5zZXRTdGFydCgoMCwgX2RvbU11dGF0aW9uLnNwbGl0VGV4dCkoc3RhcnRDb250YWluZXIsIHN0YXJ0T2Zmc2V0KSwgMCk7XG5cdFxuXHQgIHZhciBub2RlSXRlcmF0b3IgPSBkb2N1bWVudC5jcmVhdGVOb2RlSXRlcmF0b3IocmFuZ2UuY29tbW9uQW5jZXN0b3JDb250YWluZXIsIE5vZGVGaWx0ZXIuU0hPV19URVhULCBmdW5jdGlvbiAobm9kZSkge1xuXHQgICAgcmV0dXJuIHJhbmdlLmludGVyc2VjdHNOb2RlKG5vZGUpICYmICFpc0VtcHR5KG5vZGUpID8gTm9kZUZpbHRlci5GSUxURVJfQUNDRVBUIDogTm9kZUZpbHRlci5GSUxURVJfUkVKRUNUO1xuXHQgIH0pO1xuXHQgIHZhciBoeWx5dEVsZW1zID0gW107XG5cdCAgZm9yICh2YXIgY3VycmVudE5vZGUsIGkgPSAxMDAwOyBpLS0gJiYgKGN1cnJlbnROb2RlID0gbm9kZUl0ZXJhdG9yLm5leHROb2RlKCkpOykge1xuXHQgICAgaHlseXRFbGVtcy5wdXNoKGN1cnJlbnROb2RlKTtcblx0ICB9XG5cdCAgcmV0dXJuIGh5bHl0RWxlbXMubWFwKGZ1bmN0aW9uIChlbGVtKSB7XG5cdCAgICB2YXIgaHlseXRFbGVtID0gcmVwbGFjZShlbGVtKTtcblx0ICAgIGh5bHl0RWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xpY2spO1xuXHQgICAgcmV0dXJuIGh5bHl0RWxlbTtcblx0ICB9KTtcblx0fTtcblx0XG5cdHZhciBfZG9tTXV0YXRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXHRcblx0dmFyIF9jb25zdGFudHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHRcblx0ZnVuY3Rpb24gcmVwbGFjZShub2RlKSB7XG5cdCAgdmFyIHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KF9jb25zdGFudHMudGFnTmFtZSk7XG5cdCAgc3Bhbi50ZXh0Q29udGVudCA9IG5vZGUudGV4dENvbnRlbnQ7XG5cdCAgdmFyIHBhcmVudE5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG5cdFxuXHQgIGlmICghcGFyZW50Tm9kZSkgdGhyb3cgbmV3IEVycm9yKF9jb25zdGFudHMubm9kZVdpdGhvdXRQYXJlbnQpO1xuXHQgIHBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHNwYW4sIG5vZGUpO1xuXHQgIHJldHVybiBzcGFuO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBpc0VtcHR5KG5vZGUpIHtcblx0ICByZXR1cm4gIS9cXFMvLnRlc3Qobm9kZS50ZXh0Q29udGVudCk7XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogNyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHRleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoaHlseXQpIHtcblx0ICAvLyB0aGlzIG1ha2VzIGFuIGFzc3VtcHRpb24gYWJvdXQgdGhlIG9yaWdpbmFsIHN0YXRlIG9mIHRoZVxuXHQgIC8vIHRleHRub2RlLiBQZXJoYXBzIHdlJ2xsIG5lZWQgdG8gaW5jb3Jwb3JhdGUgYWZmZWN0ZWRFbGVtc1xuXHQgIGh5bHl0LmVsZW1zLmZvckVhY2goZnVuY3Rpb24gKGVsZW0pIHtcblx0ICAgIHZhciB0ZXh0Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGVsZW0udGV4dENvbnRlbnQpO1xuXHQgICAgZWxlbS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCh0ZXh0Tm9kZSwgZWxlbSk7XG5cdCAgfSk7XG5cdCAgKDAsIF9zZWxlY3RlZEhpZ2hsaWdodC5nZXRTY3JvbGxJbmRpY2F0b3IpKGh5bHl0KS5yZW1vdmUoKTtcblx0fTtcblx0XG5cdHZhciBfc2VsZWN0ZWRIaWdobGlnaHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiA4ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdGV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChoeWx5dHMsIG9uQ2xpY2spIHtcblx0ICBpZiAoIUFycmF5LmlzQXJyYXkoaHlseXRzKSkgaHlseXRzID0gW2h5bHl0c107XG5cdCAgaHlseXRzLmZvckVhY2goZnVuY3Rpb24gKGh5bHl0KSB7XG5cdCAgICB2YXIgcmFuZ2UgPSBnZXRIeWx5dFJhbmdlKGh5bHl0KTtcblx0ICAgIGlmICgoMCwgX2hpZ2hsaWdodC5pc1ZhbGlkUmFuZ2UpKHJhbmdlKSkge1xuXHQgICAgICBoeWx5dC5lbGVtcyA9ICgwLCBfY3JlYXRlRWxlbXMyLmRlZmF1bHQpKHJhbmdlLCBmdW5jdGlvbiAoZXZ0KSB7XG5cdCAgICAgICAgcmV0dXJuIG9uQ2xpY2sgJiYgb25DbGljayhoeWx5dCwgZXZ0KTtcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfSk7XG5cdCAgdmFyIGhhc2hTdGFydCA9ICcjaGktJztcblx0ICBoeWx5dHMuZm9yRWFjaChmdW5jdGlvbiAoaGwpIHtcblx0ICAgIHJldHVybiAoMCwgX3NlbGVjdGVkSGlnaGxpZ2h0LmFkZFNjcm9sbEluZGljYXRvcikoaGwsIG9uQ2xpY2spO1xuXHQgIH0pO1xuXHQgIHZhciBoeWx5dElkID0gdm9pZCAwO1xuXHQgIGlmICghbG9jYXRpb24uaGFzaC5pbmRleE9mKGhhc2hTdGFydCkpIHtcblx0ICAgIGh5bHl0SWQgPSBwYXJzZUludChsb2NhdGlvbi5oYXNoLnN1YnN0cihoYXNoU3RhcnQubGVuZ3RoKSk7XG5cdCAgICB2YXIgaHlseXQgPSBoeWx5dHMuZmluZChmdW5jdGlvbiAoaGwpIHtcblx0ICAgICAgcmV0dXJuIGhsLmlkID09PSBoeWx5dElkO1xuXHQgICAgfSk7XG5cdCAgICBpZiAoaHlseXQpICgwLCBfc2VsZWN0ZWRIaWdobGlnaHQuc2Nyb2xsVG9IaWdobGlnaHQpKGh5bHl0KTtcblx0ICB9XG5cdCAgLy8gY29uc3QgaW50ZXJ2YWxJZCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiBwbGFjZUluZGljYXRvcnMoaHlseXRzKSwgNTAwMCk7XG5cdCAgd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHBsYWNlSW5kaWNhdG9ycyhoeWx5dHMpO1xuXHQgICAgLy8gd2luZG93LmNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XG5cdCAgfTtcblx0ICByZXR1cm4gaHlseXRJZDtcblx0fTtcblx0XG5cdHZhciBfc2VsZWN0ZWRIaWdobGlnaHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9jcmVhdGVFbGVtcyA9IF9fd2VicGFja19yZXF1aXJlX18oNik7XG5cdFxuXHR2YXIgX2NyZWF0ZUVsZW1zMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUVsZW1zKTtcblx0XG5cdHZhciBfaGlnaGxpZ2h0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBnZXRUZXh0Tm9kZShwYXJlbnRTZWxlY3RvciwgaW5kZXgpIHtcblx0ICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihwYXJlbnRTZWxlY3RvcikuY2hpbGROb2Rlc1tpbmRleF07XG5cdH1cblx0XG5cdFxuXHRmdW5jdGlvbiBnZXRIeWx5dFJhbmdlKGh5bHl0KSB7XG5cdCAgdmFyIHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtcblx0ICB2YXIgc3RhcnROb2RlID0gdm9pZCAwO1xuXHQgIHZhciBlbmROb2RlID0gdm9pZCAwO1xuXHQgIGlmIChoeWx5dC5lbGVtcykge1xuXHQgICAgcmFuZ2Uuc2V0U3RhcnRCZWZvcmUoaHlseXQuZWxlbXNbMF0pO1xuXHQgICAgcmFuZ2Uuc2V0RW5kQWZ0ZXIoaHlseXQuZWxlbXNbaHlseXQuZWxlbXMubGVuZ3RoIC0gMV0pO1xuXHQgIH0gZWxzZSB7XG5cdCAgICBzdGFydE5vZGUgPSBnZXRUZXh0Tm9kZShoeWx5dC5zdGFydFNlbGVjdG9yLCBoeWx5dC5zdGFydE5vZGVJbmRleCk7XG5cdCAgICBlbmROb2RlID0gZ2V0VGV4dE5vZGUoaHlseXQuZW5kU2VsZWN0b3IsIGh5bHl0LmVuZE5vZGVJbmRleCk7XG5cdCAgICByYW5nZS5zZXRTdGFydChzdGFydE5vZGUsIGh5bHl0LnN0YXJ0T2Zmc2V0KTtcblx0ICAgIHJhbmdlLnNldEVuZChlbmROb2RlLCBoeWx5dC5lbmRPZmZzZXQpO1xuXHQgIH1cblx0ICByZXR1cm4gcmFuZ2U7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHBsYWNlSW5kaWNhdG9ycyhoeWx5dHMpIHtcblx0ICBoeWx5dHMuZm9yRWFjaChmdW5jdGlvbiAoaGwpIHtcblx0ICAgIHJldHVybiAoMCwgX3NlbGVjdGVkSGlnaGxpZ2h0LnBsYWNlU2Nyb2xsSW5kaWNhdG9yKShobCk7XG5cdCAgfSk7XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9XG4vKioqKioqLyBdKVxufSk7XG47XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGhpYm91LWhpZ2hsaWdodGVyLm1pbi5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIDUzNjAwNTBhY2M2YTc3MDBhZTM3IiwiZXhwb3J0IHsgY2hhbmdlU2VsZWN0ZWRIaWdobGlnaHQsIHNob3dTY3JvbGxJbmRpY2F0b3IsIHNjcm9sbFRvSGlnaGxpZ2h0IH0gZnJvbSAnLi9zZWxlY3RlZC1oaWdobGlnaHQnO1xuZXhwb3J0IHsgaGlnaGxpZ2h0LCBoaWdobGlnaHRSYW5nZSB9IGZyb20gJy4vaGlnaGxpZ2h0JztcbmV4cG9ydCB7IGRlZmF1bHQgYXMgcmVtb3ZlSHlseXRFbGVtcyB9IGZyb20gJy4vcmVtb3ZlJztcbmV4cG9ydCB7IGRlZmF1bHQgYXMgcmVzdG9yZSB9IGZyb20gJy4vcmVzdG9yZSc7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaW5kZXguanMiLCIvLyBAZmxvd1xuaW1wb3J0IHsgZ2V0SW5kaWNhdG9yQ2xhc3NOYW1lLCBnZXRJbmRpY2F0b3JTZWxlY3RvciB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB0eXBlIHsgSHlseXQgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5cbmZ1bmN0aW9uIHRvZ2dsZVNlbGVjdGVkQ2xhc3MoZWxlbXMpIHtcbiAgZm9yIChsZXQgaSA9IGVsZW1zLmxlbmd0aDsgaS0tOykgZWxlbXNbaV0uY2xhc3NMaXN0LnRvZ2dsZSgnaGktc2VsZWN0ZWQnKTtcbn1cblxuY29uc3Qgc2VsZWN0SGwgPSAoaHlseXQpID0+IHNldFRpbWVvdXQoKCkgPT4ge1xuICBpZiAoIShoeWx5dCAmJiBoeWx5dC5lbGVtcyAmJiBoeWx5dC5lbGVtcy5sZW5ndGgpKSByZXR1cm47XG4gIGNvbnN0IHNlbGVjdGlvbiA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpO1xuICBpZiAoIXNlbGVjdGlvbikgcmV0dXJuO1xuICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gIGNvbnN0IHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtcbiAgcmFuZ2Uuc2V0U3RhcnRCZWZvcmUoaHlseXQuZWxlbXNbMF0pO1xuICByYW5nZS5zZXRFbmRBZnRlcihoeWx5dC5lbGVtc1toeWx5dC5lbGVtcy5sZW5ndGggLSAxXSk7XG4gIHNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7XG59KTtcblxuZnVuY3Rpb24gZGVhY3RpdmF0ZVNjcm9sbEluZGljYXRvcigpIHtcbiAgY29uc3QgYWN0aXZlU2Nyb2xsSW5kaWNhdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhpLXNjcm9sbC1pbmRpY2F0b3IuYWN0aXZlJyk7XG4gIGlmIChhY3RpdmVTY3JvbGxJbmRpY2F0b3IpIGFjdGl2ZVNjcm9sbEluZGljYXRvci5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbn1cblxuZnVuY3Rpb24gZ2V0U2Nyb2xsSW5kaWNhdG9yKGh5bHl0KSB7XG4gIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGdldEluZGljYXRvclNlbGVjdG9yKGh5bHl0LmlkKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGFuZ2VTZWxlY3RlZEhpZ2hsaWdodChsYXN0SHlseXQ6IE9iamVjdCwgaHlseXQ6IE9iamVjdCkge1xuICBpZiAobGFzdEh5bHl0KSB0b2dnbGVTZWxlY3RlZENsYXNzKGxhc3RIeWx5dC5lbGVtcyk7XG4gIGRlYWN0aXZhdGVTY3JvbGxJbmRpY2F0b3IoKTtcbiAgaWYgKGh5bHl0KSB7XG4gICAgc2VsZWN0SGwoaHlseXQpO1xuICAgIGlmIChsYXN0SHlseXQgIT09IGh5bHl0KSB0b2dnbGVTZWxlY3RlZENsYXNzKGh5bHl0LmVsZW1zKTtcbiAgICBnZXRTY3JvbGxJbmRpY2F0b3IoaHlseXQpLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdldFRvcChlbGVtczogQXJyYXk8SFRNTEVsZW1lbnQ+KSB7XG4gIHJldHVybiAoXG4gICAgKChlbGVtc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgK1xuICAgIGVsZW1zW2VsZW1zLmxlbmd0aCAtIDFdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbSkgLyAyKVxuICAgICsgd2luZG93LnNjcm9sbFlcbiAgKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlU2Nyb2xsSW5kaWNhdG9yKGh5bHl0OiBIeWx5dCwgb25DbGljaz86IEZ1bmN0aW9uKSB7XG4gIGNvbnN0IGluZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBpbmRpY2F0b3IuY2xhc3NOYW1lID0gZ2V0SW5kaWNhdG9yQ2xhc3NOYW1lKGh5bHl0LmlkKTtcbiAgLy8gaW5kaWNhdG9yLmhyZWYgPSAnI2hpLScgKyBoeWx5dC5pZDtcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpbmRpY2F0b3IpO1xuICBpbmRpY2F0b3IuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgd2luZG93LnNjcm9sbFRvKDAsIChnZXRUb3AoaHlseXQuZWxlbXMpIC0gd2luZG93LmlubmVySGVpZ2h0KSAvIDIpO1xuICAgIGlmIChvbkNsaWNrKSBvbkNsaWNrKGh5bHl0LCBldnQpO1xuICB9KTtcbiAgcmV0dXJuIGluZGljYXRvcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBsYWNlU2Nyb2xsSW5kaWNhdG9yKGh5bHl0OiBIeWx5dCwgaW5kaWNhdG9yPzogSFRNTEVsZW1lbnQpIHtcbiAgY29uc3QgdG9wID0gZ2V0VG9wKGh5bHl0LmVsZW1zKTtcbiAgY29uc3QgZml4ZWRUb3AgPSAodG9wIC8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbEhlaWdodCkgKiB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gIGlmICghaW5kaWNhdG9yKSBpbmRpY2F0b3IgPSBnZXRTY3JvbGxJbmRpY2F0b3IoaHlseXQpO1xuICBpbmRpY2F0b3Iuc3R5bGUudG9wID0gYCR7Zml4ZWRUb3AgLSAxMH1weGA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRTY3JvbGxJbmRpY2F0b3IoaHlseXQ6IEh5bHl0LCBvbkNsaWNrPzogRnVuY3Rpb24pIHtcbiAgY29uc3Qgc2Nyb2xsSW5kaWNhdG9yID0gY3JlYXRlU2Nyb2xsSW5kaWNhdG9yKGh5bHl0LCBvbkNsaWNrKTtcbiAgcGxhY2VTY3JvbGxJbmRpY2F0b3IoaHlseXQsIHNjcm9sbEluZGljYXRvcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzY3JvbGxUb0hpZ2hsaWdodChoeWx5dDogSHlseXQpIHtcbiAgY29uc3QgdG9wID0gZ2V0VG9wKGh5bHl0LmVsZW1zKTtcbiAgd2luZG93LnNjcm9sbFRvKCh0b3AgLSB3aW5kb3cuaW5uZXJIZWlnaHQpIC8gMik7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvc2VsZWN0ZWQtaGlnaGxpZ2h0LmpzIiwiLy8gQGZsb3dcbmV4cG9ydCBmdW5jdGlvbiBnZXRJbmRpY2F0b3JDbGFzc05hbWUoaHlseXRJZDogbnVtYmVyKSB7XG4gIHJldHVybiBgaGktc2Nyb2xsLWluZGljYXRvciBoaS0ke2h5bHl0SWR9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEluZGljYXRvclNlbGVjdG9yKGh5bHl0SWQ6IG51bWJlcikge1xuICByZXR1cm4gYC5oaS1zY3JvbGwtaW5kaWNhdG9yLmhpLSR7aHlseXRJZH1gO1xufVxuXG5leHBvcnQgY29uc3QgdGFnTmFtZSA9ICdoeWx5dCc7XG5leHBvcnQgY29uc3QgcmFuZ2VOb3RUZXh0Tm9kZUVycm9yID0gJ1JhbmdlIHN0YXJ0IG9yIGVuZCBpcyBub3QgYSB0ZXh0IG5vZGUuJztcbmV4cG9ydCBjb25zdCBub2RlV2l0aG91dFBhcmVudCA9IFwiQ2FuJ3QgcmVwbGFjZSBub2RlLiBEb2Vzbid0IGhhdmUgYSBwYXJlbnRcIjtcblxuZXhwb3J0IHR5cGUgSHlseXQgPSB7XG4gIGlkOiBudW1iZXIsXG4gIGh0bWw6IHN0cmluZyxcbiAgc3RhcnRTZWxlY3Rvcjogc3RyaW5nLFxuICBzdGFydE5vZGVJbmRleDogbnVtYmVyLFxuICBzdGFydE9mZnNldDogbnVtYmVyLFxuICBlbmRTZWxlY3Rvcjogc3RyaW5nLFxuICBlbmROb2RlSW5kZXg6IG51bWJlcixcbiAgZW5kT2Zmc2V0OiBudW1iZXIsXG4gIGRlbGV0ZWQ6IGJvb2wsXG4gIGVsZW1zOiBBcnJheTxPYmplY3Q+XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29uc3RhbnRzLmpzIiwiLy8gQGZsb3dcbmltcG9ydCB7IGdldExvY2F0aW9uIH0gZnJvbSAnLi9kb20tbXV0YXRpb24nO1xuaW1wb3J0IGdldFNlbGVjdG9yIGZyb20gJy4vZ2V0LXNlbGVjdG9yJztcbmltcG9ydCBjcmVhdGVFbGVtcyBmcm9tICcuL2NyZWF0ZS1lbGVtcyc7XG5pbXBvcnQgeyBhZGRTY3JvbGxJbmRpY2F0b3IgfSBmcm9tICcuL3NlbGVjdGVkLWhpZ2hsaWdodCc7XG5pbXBvcnQgeyB0YWdOYW1lIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHR5cGUgeyBIeWx5dCB9IGZyb20gJy4vY29uc3RhbnRzJztcblxuZnVuY3Rpb24gZ2V0UmFuZ2VIdG1sKHJhbmdlKSB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IChyYW5nZS5jb21tb25BbmNlc3RvckNvbnRhaW5lci5wYXJlbnRFbGVtZW50IHx8XG4gICAgZG9jdW1lbnQuYm9keSkuY2xvbmVOb2RlKGZhbHNlKTtcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHJhbmdlLmNsb25lQ29udGVudHMoKSk7XG4gIHJldHVybiBjb250YWluZXIuaW5uZXJIVE1MO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZFJhbmdlKHJhbmdlOiBSYW5nZSkge1xuICBjb25zdCB7IHN0YXJ0Q29udGFpbmVyLCBlbmRDb250YWluZXIgfSA9IHJhbmdlO1xuICByZXR1cm4gKFxuICAgIHN0YXJ0Q29udGFpbmVyIGluc3RhbmNlb2YgVGV4dCAmJlxuICAgIGVuZENvbnRhaW5lciBpbnN0YW5jZW9mIFRleHQgJiZcbiAgICBzdGFydENvbnRhaW5lci5wYXJlbnRFbGVtZW50ICYmXG4gICAgc3RhcnRDb250YWluZXIucGFyZW50RWxlbWVudC5sb2NhbE5hbWUgIT09IHRhZ05hbWUgJiZcbiAgICBlbmRDb250YWluZXIucGFyZW50RWxlbWVudCAmJlxuICAgIGVuZENvbnRhaW5lci5wYXJlbnRFbGVtZW50LmxvY2FsTmFtZSAhPT0gdGFnTmFtZVxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGlnaGxpZ2h0UmFuZ2UoaWQ6IG51bWJlciwgcmFuZ2U6IFJhbmdlLCBvbkNsaWNrPzogRnVuY3Rpb24pOiA/SHlseXQge1xuICBpZiAoIWlzVmFsaWRSYW5nZShyYW5nZSkpIHJldHVybiBudWxsO1xuICBjb25zdCB7IHN0YXJ0Q29udGFpbmVyLCBlbmRDb250YWluZXIgfSA9IHJhbmdlO1xuICBjb25zdCBzdGFydExvY2F0aW9uID0gZ2V0TG9jYXRpb24oc3RhcnRDb250YWluZXIpO1xuICBjb25zdCBlbmRMb2NhdGlvbiA9IGdldExvY2F0aW9uKGVuZENvbnRhaW5lcik7XG4gIGNvbnN0IGh5bHl0ID0ge1xuICAgIGlkLFxuICAgIGh0bWw6IGdldFJhbmdlSHRtbChyYW5nZSksXG4gICAgc3RhcnRTZWxlY3RvcjogZ2V0U2VsZWN0b3Ioc3RhcnRDb250YWluZXIpLFxuICAgIHN0YXJ0Tm9kZUluZGV4OiBzdGFydExvY2F0aW9uLmluZGV4LFxuICAgIHN0YXJ0T2Zmc2V0OiByYW5nZS5zdGFydE9mZnNldCArIHN0YXJ0TG9jYXRpb24ub2Zmc2V0LFxuICAgIGVuZFNlbGVjdG9yOiBnZXRTZWxlY3RvcihlbmRDb250YWluZXIpLFxuICAgIGVuZE5vZGVJbmRleDogZW5kTG9jYXRpb24uaW5kZXgsXG4gICAgZW5kT2Zmc2V0OiByYW5nZS5lbmRPZmZzZXQgKyBlbmRMb2NhdGlvbi5vZmZzZXQsXG4gICAgZGVsZXRlZDogZmFsc2UsXG4gICAgZWxlbXM6IGNyZWF0ZUVsZW1zKHJhbmdlLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiBvbkNsaWNrICYmIG9uQ2xpY2soaHlseXQsIGV2dCkpXG4gIH07XG4gIHJldHVybiBoeWx5dDtcbn1cblxuZnVuY3Rpb24gaGlnaGxpZ2h0U2VsZWN0aW9uKHNlbGVjdGlvbiwgaWQ6IG51bWJlciwgb25DbGljaz86IEZ1bmN0aW9uKSB7XG4gIGxldCBpID0gMDtcbiAgY29uc3QgcmFuZ2UgPSBzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKTtcbiAgY29uc3QgeyBzdGFydE9mZnNldCwgc3RhcnRDb250YWluZXIsIGVuZENvbnRhaW5lciB9ID0gcmFuZ2U7XG4gIGlmIChyYW5nZS5jb2xsYXBzZWQgfHwgIWlzVmFsaWRSYW5nZShyYW5nZSkgfHxcbiAgICAgIChzdGFydENvbnRhaW5lciA9PT0gZW5kQ29udGFpbmVyICYmXG4gICAgICByYW5nZS5lbmRPZmZzZXQgLSBzdGFydE9mZnNldCA8IDMpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmFuZ2UuY29tbW9uQW5jZXN0b3JDb250YWluZXIubm9ybWFsaXplKCk7XG4gIGZvciAobGV0IGxlbiA9IHNlbGVjdGlvbi5yYW5nZUNvdW50IC0gMTtcbiAgICAgIGkgPCBsZW4gJiYgcmFuZ2UuZW5kQ29udGFpbmVyLm5vZGVUeXBlICE9PSBOb2RlLlRFWFRfTk9ERTtcbiAgICAgIGkrKykge1xuICAgIGNvbnN0IGN1cnJlbnRSYW5nZSA9IHNlbGVjdGlvbi5nZXRSYW5nZUF0KGkpO1xuICAgIHJhbmdlLnNldEVuZChjdXJyZW50UmFuZ2UuZW5kQ29udGFpbmVyLCBjdXJyZW50UmFuZ2UuZW5kT2Zmc2V0KTtcbiAgfVxuICBjb25zdCByZSA9IC9bXlxcdyddL2c7XG4gIC8vaWYgZG9pbmcgdW5pY29kZSByZWdpb25zOlxuICAvLyBbXFx3XFx1MDBDMC1cXHUwMEQ2XFx1MDBEOC1cXHUwMEY2XFx1MDBGOC1cXHUwMUJGXFx1MDFDNC1cXHUwMmI4XVxuICBsZXQgbGFzdEluZGV4ID0gMDtcbiAgd2hpbGUgKHJlLmxhc3RJbmRleCA8PSBzdGFydE9mZnNldCkge1xuICAgIGxhc3RJbmRleCA9IHJlLmxhc3RJbmRleDtcbiAgICBpZiAoIXJlLmV4ZWMocmFuZ2Uuc3RhcnRDb250YWluZXIudGV4dENvbnRlbnQpKSBicmVhaztcbiAgfVxuICByYW5nZS5zZXRTdGFydChyYW5nZS5zdGFydENvbnRhaW5lciwgbGFzdEluZGV4KTtcbiAgcmUubGFzdEluZGV4ID0gMDtcbiAgY29uc3QgcG9zdEVuZFN0cmluZyA9IHJhbmdlLmVuZENvbnRhaW5lci50ZXh0Q29udGVudC5zdWJzdHIocmFuZ2UuZW5kT2Zmc2V0KTtcbiAgbGFzdEluZGV4ID0gcG9zdEVuZFN0cmluZy5zZWFyY2gocmUpO1xuICBpZiAobGFzdEluZGV4ID09PSAtMSkgbGFzdEluZGV4ID0gcG9zdEVuZFN0cmluZy5sZW5ndGg7XG4gIHJhbmdlLnNldEVuZChyYW5nZS5lbmRDb250YWluZXIsIHJhbmdlLmVuZE9mZnNldCArIGxhc3RJbmRleCk7XG5cbiAgY29uc3QgaHlseXQgPSBoaWdobGlnaHRSYW5nZShpZCwgcmFuZ2UsIG9uQ2xpY2spO1xuICBpZiAoIWh5bHl0KSByZXR1cm4gbnVsbDtcbiAgYWRkU2Nyb2xsSW5kaWNhdG9yKGh5bHl0LCBvbkNsaWNrKTtcbiAgaWYgKG9uQ2xpY2spIG9uQ2xpY2soaHlseXQpO1xuICByZXR1cm4gaHlseXQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoaWdobGlnaHQoaWQ6IG51bWJlciwgb25DbGljaz86IEZ1bmN0aW9uKSB7XG4gIC8vIEhpZ2hsaWdodCBpZiB0ZXh0IHNlbGVjdGVkXG4gIGNvbnN0IHNlbGVjdGlvbiA9IGdldFNlbGVjdGlvbigpO1xuICBpZiAoc2VsZWN0aW9uICYmICFzZWxlY3Rpb24uaXNDb2xsYXBzZWQpIHtcbiAgICByZXR1cm4gaGlnaGxpZ2h0U2VsZWN0aW9uKHNlbGVjdGlvbiwgaWQsIG9uQ2xpY2spO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2hpZ2hsaWdodC5qcyIsIi8vQGZsb3dcbmNvbnN0IGFmZmVjdGVkRWxlbXMgPSBuZXcgV2Vha01hcCgpO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9jYXRpb24odGV4dE5vZGU6IFRleHQpIHtcbiAgY29uc3QgcGFyZW50ID0gdGV4dE5vZGUucGFyZW50Tm9kZSB8fCBkb2N1bWVudC5ib2R5O1xuICBsZXQgbm9kZUluZGV4ID0gW10uaW5kZXhPZi5jYWxsKHBhcmVudC5jaGlsZE5vZGVzLCB0ZXh0Tm9kZSk7XG4gIGNvbnN0IGFmZmVjdGVkID0gYWZmZWN0ZWRFbGVtcy5nZXQocGFyZW50KTtcbiAgaWYgKCFhZmZlY3RlZCkgcmV0dXJuIHtcbiAgICBpbmRleDogbm9kZUluZGV4LFxuICAgIG9mZnNldDogMFxuICB9O1xuICAvLyBsZWF2aW5nIGZvci4uLmluIHVudGlsIEkgY2FuIHRlc3RcbiAgZm9yIChsZXQgaW5kZXggaW4gYWZmZWN0ZWQpIHtcbiAgICBpbmRleCAqPSAxO1xuICAgIGxldCBzcGxpdHMgPSBhZmZlY3RlZFtpbmRleF07XG4gICAgaWYgKGluZGV4ID4gbm9kZUluZGV4KSBicmVhaztcbiAgICBpZiAobm9kZUluZGV4ID49IHNwbGl0cy5sZW5ndGggKyBpbmRleClcbiAgICAgIG5vZGVJbmRleCAtPSBzcGxpdHMubGVuZ3RoO1xuICAgIGVsc2UgaWYgKG5vZGVJbmRleCA+IGluZGV4KSByZXR1cm4ge1xuICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgb2Zmc2V0OiBzcGxpdHNbbm9kZUluZGV4IC0gaW5kZXggLSAxXVxuICAgIH07XG4gICAgaWYgKGluZGV4ID09PSBub2RlSW5kZXgpIHtcbiAgICAgIGNvbnN0IGxlbiA9IHNwbGl0cy5sZW5ndGg7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbmRleDogbm9kZUluZGV4LFxuICAgICAgICBvZmZzZXQ6IGxlbiA/IHNwbGl0c1tsZW4gLSAxXSA6IDBcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIC8qY29uc3QgaW5kZXggPSBhZmZlY3RlZC5maW5kSW5kZXgoKHNwbGl0cywgaTogbnVtYmVyKSA9PiB7XG4gICAgaWYgKGkgPiBub2RlSW5kZXgpIHJldHVybiBmYWxzZTtcbiAgICBpZiAobm9kZUluZGV4ID49IHNwbGl0cy5sZW5ndGggKyBpKSBub2RlSW5kZXggLT0gc3BsaXRzLmxlbmd0aDtcbiAgICBpZiAobm9kZUluZGV4ID49IGkpIHJldHVybiB0cnVlO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSk7XG4gIC8vIGNhbiB0aGlzIGV2ciBoYXBwZW4/XG4gIGlmIChub2RlSW5kZXggPiBpbmRleCkqL1xuICByZXR1cm4ge1xuICAgIGluZGV4OiBub2RlSW5kZXgsXG4gICAgb2Zmc2V0OiAwXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzcGxpdFRleHQobm9kZTogVGV4dCwgb2Zmc2V0OiBudW1iZXIpIHtcbiAgaWYgKCFvZmZzZXQgfHwgb2Zmc2V0ID09PSBub2RlLmRhdGEubGVuZ3RoKSByZXR1cm4gbm9kZTtcbiAgY29uc3QgcGFyZW50Tm9kZSA9IHsgbm9kZSB9O1xuICBjb25zdCBuZXdOb2RlID0gbm9kZS5zcGxpdFRleHQob2Zmc2V0KTtcbiAgY29uc3QgbG9jYXRpb246IHsgaW5kZXg6IG51bWJlciwgb2Zmc2V0OiBudW1iZXIgfSA9IGdldExvY2F0aW9uKG5vZGUpO1xuICBsZXQgYWZmZWN0ZWQgPSBhZmZlY3RlZEVsZW1zLmdldChwYXJlbnROb2RlKTtcbiAgaWYgKCFhZmZlY3RlZCkge1xuICAgIGFmZmVjdGVkID0gW107XG4gICAgYWZmZWN0ZWRFbGVtcy5zZXQocGFyZW50Tm9kZSwgYWZmZWN0ZWQpO1xuICB9XG4gIGlmICghYWZmZWN0ZWRbbG9jYXRpb24uaW5kZXhdKSBhZmZlY3RlZFtsb2NhdGlvbi5pbmRleF0gPSBbXTtcbiAgYWZmZWN0ZWRbbG9jYXRpb24uaW5kZXhdLnB1c2gobG9jYXRpb24ub2Zmc2V0ICsgb2Zmc2V0KTtcbiAgYWZmZWN0ZWRbbG9jYXRpb24uaW5kZXhdLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbiAgcmV0dXJuIG5ld05vZGU7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvZG9tLW11dGF0aW9uLmpzIiwiLyoqXG4gKiBGaW5kIGEgdW5pcXVlIENTUyBzZWxlY3RvciBmb3IgYSBnaXZlbiBlbGVtZW50XG4gKiBAcmV0dXJucyBhIHN0cmluZyBzdWNoIHRoYXQgZWxlLm93bmVyRG9jdW1lbnQucXVlcnlTZWxlY3RvcihyZXBseSkgPT09IGVsZVxuICogYW5kIGVsZS5vd25lckRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwocmVwbHkpLmxlbmd0aCA9PT0gMVxuICovXG5cbnZhciBnZXROdGhPZlR5cGUgPSBmdW5jdGlvbihlbGVtKSB7XG4gIHZhciBzaWJsaW5ncyA9IFtdLnNsaWNlLmNhbGwoZWxlbS5wYXJlbnROb2RlLmNoaWxkcmVuKTtcbiAgZm9yIChsZXQgaSA9IHNpYmxpbmdzLmxlbmd0aDsgaS0tOykge1xuICAgIGlmIChzaWJsaW5nc1tpXS5sb2NhbE5hbWUgIT09IGVsZW0ubG9jYWxOYW1lKVxuICAgICAgW10uc3BsaWNlLmNhbGwoc2libGluZ3MsIGksIDEpO1xuICB9XG4gIHZhciBpbmRleCA9IFtdLmluZGV4T2YuY2FsbChzaWJsaW5ncywgZWxlbSkgKyAxO1xuICByZXR1cm4gJzpudGgtb2YtdHlwZSgnICsgaW5kZXggKyAnKSc7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRTZWxlY3RvcihlbGUpIHtcbiAgaWYgKGVsZS5ub2RlVHlwZT09PU5vZGUuVEVYVF9OT0RFKSBlbGUgPSBlbGUucGFyZW50Tm9kZTtcbiAgdmFyIGRvY3VtZW50ID0gZWxlLm93bmVyRG9jdW1lbnQ7XG4gIGlmIChlbGUuaWQgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlLmlkKSA9PT0gZWxlKSB7XG4gICAgcmV0dXJuICcjJyArIGVsZS5pZDtcbiAgfVxuXG4gIC8vIEluaGVyZW50bHkgdW5pcXVlIGJ5IHRhZyBuYW1lXG4gIHZhciB0YWdOYW1lID0gZWxlLnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgaWYgKHRhZ05hbWU9PT0naHRtbCcgfHwgdGFnTmFtZT09PSdoZWFkJyB8fCB0YWdOYW1lPT09J2JvZHknKVxuICAgIHJldHVybiB0YWdOYW1lO1xuXG4gIGlmICghZWxlLnBhcmVudE5vZGUpIGNvbnNvbGUud2FybignZGFuZ2VyOiAnICsgdGFnTmFtZSk7XG5cbiAgLy8gV2UgbWlnaHQgYmUgYWJsZSB0byBmaW5kIGEgdW5pcXVlIGNsYXNzIG5hbWVcbiAgdmFyIGlzVW5pcXVlID0gZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgICB0cnkge1xuICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpLmxlbmd0aD09PTEpIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIHZhciBzZWxlY3RvcjtcbiAgaWYgKGVsZS5jbGFzc0xpc3QubGVuZ3RoID4gMCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlLmNsYXNzTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgLy8gSXMgdGhpcyBjbGFzc05hbWUgdW5pcXVlIGJ5IGl0c2VsZj9cbiAgICAgIHNlbGVjdG9yID0gJy4nICsgZWxlLmNsYXNzTGlzdC5pdGVtKGkpO1xuICAgICAgaWYgKGlzVW5pcXVlKHNlbGVjdG9yKSkgcmV0dXJuIHNlbGVjdG9yO1xuICAgICAgLy8gTWF5YmUgaXQncyB1bmlxdWUgd2l0aCBhIHRhZyBuYW1lP1xuICAgICAgc2VsZWN0b3IgPSB0YWdOYW1lICsgc2VsZWN0b3I7XG4gICAgICBpZiAoaXNVbmlxdWUoc2VsZWN0b3IpKSByZXR1cm4gc2VsZWN0b3I7XG4gICAgICAvLyBNYXliZSBpdCdzIHVuaXF1ZSB1c2luZyBhIHRhZyBuYW1lIGFuZCBudGgtY2hpbGRcbiAgICAgIHNlbGVjdG9yID0gc2VsZWN0b3IgKyBnZXROdGhPZlR5cGUoZWxlKTtcbiAgICAgIGlmIChpc1VuaXF1ZShzZWxlY3RvcikpIHJldHVybiBzZWxlY3RvcjtcbiAgICB9XG4gIH1cblxuICAvLyBTbyB3ZSBjYW4gYmUgdW5pcXVlIHcuci50LiBvdXIgcGFyZW50LCBhbmQgdXNlIHJlY3Vyc2lvblxuICBzZWxlY3RvciA9IGdldFNlbGVjdG9yKGVsZS5wYXJlbnROb2RlKSArICcgPiAnICsgdGFnTmFtZSArIGdldE50aE9mVHlwZShlbGUpO1xuXG4gIHJldHVybiBzZWxlY3Rvcjtcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvZ2V0LXNlbGVjdG9yLmpzIiwiLy8gQGZsb3dcblxuaW1wb3J0IHsgc3BsaXRUZXh0IH0gZnJvbSAnLi9kb20tbXV0YXRpb24nO1xuaW1wb3J0IHsgdGFnTmFtZSwgcmFuZ2VOb3RUZXh0Tm9kZUVycm9yLCBub2RlV2l0aG91dFBhcmVudCB9IGZyb20gJy4vY29uc3RhbnRzJztcblxuZnVuY3Rpb24gcmVwbGFjZShub2RlKSB7XG4gIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZ05hbWUpO1xuICBzcGFuLnRleHRDb250ZW50ID0gbm9kZS50ZXh0Q29udGVudDtcbiAgY29uc3QgeyBwYXJlbnROb2RlIH0gPSBub2RlO1xuICBpZiAoIXBhcmVudE5vZGUpIHRocm93IG5ldyBFcnJvcihub2RlV2l0aG91dFBhcmVudCk7XG4gIHBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHNwYW4sIG5vZGUpO1xuICByZXR1cm4gc3Bhbjtcbn1cblxuZnVuY3Rpb24gaXNFbXB0eShub2RlKSB7XG4gIHJldHVybiAhL1xcUy8udGVzdChub2RlLnRleHRDb250ZW50KTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKHJhbmdlOiBSYW5nZSwgb25DbGljazogRnVuY3Rpb24pOiBBcnJheTxIVE1MRWxlbWVudD4ge1xuICBjb25zdCB7IHN0YXJ0T2Zmc2V0LCBzdGFydENvbnRhaW5lciwgZW5kQ29udGFpbmVyLCBlbmRPZmZzZXQgfSA9IHJhbmdlO1xuICBpZiAoIShzdGFydENvbnRhaW5lciBpbnN0YW5jZW9mIFRleHQgJiYgZW5kQ29udGFpbmVyIGluc3RhbmNlb2YgVGV4dCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IocmFuZ2VOb3RUZXh0Tm9kZUVycm9yKTtcbiAgfVxuICBzcGxpdFRleHQoZW5kQ29udGFpbmVyLCBlbmRPZmZzZXQpO1xuICByYW5nZS5zZXRTdGFydChzcGxpdFRleHQoc3RhcnRDb250YWluZXIsIHN0YXJ0T2Zmc2V0KSwgMCk7XG5cbiAgY29uc3Qgbm9kZUl0ZXJhdG9yID0gZG9jdW1lbnQuY3JlYXRlTm9kZUl0ZXJhdG9yKFxuICAgIHJhbmdlLmNvbW1vbkFuY2VzdG9yQ29udGFpbmVyLFxuICAgIE5vZGVGaWx0ZXIuU0hPV19URVhULFxuICAgIChub2RlKSA9PiByYW5nZS5pbnRlcnNlY3RzTm9kZShub2RlKSAmJiAhaXNFbXB0eShub2RlKSA/XG4gICAgICBOb2RlRmlsdGVyLkZJTFRFUl9BQ0NFUFQgOiBOb2RlRmlsdGVyLkZJTFRFUl9SRUpFQ1RcbiAgKTtcbiAgY29uc3QgaHlseXRFbGVtcyA9IFtdO1xuICBmb3IgKGxldCBjdXJyZW50Tm9kZSwgaSA9IDEwMDA7IGktLSAmJiAoY3VycmVudE5vZGUgPSBub2RlSXRlcmF0b3IubmV4dE5vZGUoKSk7KSB7XG4gICAgaHlseXRFbGVtcy5wdXNoKGN1cnJlbnROb2RlKTtcbiAgfVxuICByZXR1cm4gaHlseXRFbGVtcy5tYXAoKGVsZW0pID0+IHtcbiAgICBjb25zdCBoeWx5dEVsZW0gPSByZXBsYWNlKGVsZW0pO1xuICAgIGh5bHl0RWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xpY2spO1xuICAgIHJldHVybiBoeWx5dEVsZW07XG4gIH0pO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NyZWF0ZS1lbGVtcy5qcyIsIi8vIEBmbG93XG5pbXBvcnQgeyBnZXRTY3JvbGxJbmRpY2F0b3IgfSBmcm9tICcuL3NlbGVjdGVkLWhpZ2hsaWdodCc7XG5pbXBvcnQgdHlwZSB7IEh5bHl0IH0gZnJvbSAnLi9jb25zdGFudHMnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoaHlseXQ6IEh5bHl0KSB7XG4gIC8vIHRoaXMgbWFrZXMgYW4gYXNzdW1wdGlvbiBhYm91dCB0aGUgb3JpZ2luYWwgc3RhdGUgb2YgdGhlXG4gIC8vIHRleHRub2RlLiBQZXJoYXBzIHdlJ2xsIG5lZWQgdG8gaW5jb3Jwb3JhdGUgYWZmZWN0ZWRFbGVtc1xuICBoeWx5dC5lbGVtcy5mb3JFYWNoKChlbGVtKSA9PiB7XG4gICAgY29uc3QgdGV4dE5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShlbGVtLnRleHRDb250ZW50KTtcbiAgICBlbGVtLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHRleHROb2RlLCBlbGVtKTtcbiAgfSk7XG4gIGdldFNjcm9sbEluZGljYXRvcihoeWx5dCkucmVtb3ZlKCk7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvcmVtb3ZlLmpzIiwiLy8gQGZsb3dcbmltcG9ydCB7IGFkZFNjcm9sbEluZGljYXRvciwgcGxhY2VTY3JvbGxJbmRpY2F0b3IsIHNjcm9sbFRvSGlnaGxpZ2h0IH0gZnJvbSAnLi9zZWxlY3RlZC1oaWdobGlnaHQnO1xuaW1wb3J0IGNyZWF0ZUVsZW1zIGZyb20gJy4vY3JlYXRlLWVsZW1zJztcbmltcG9ydCB7IGlzVmFsaWRSYW5nZSB9IGZyb20gJy4vaGlnaGxpZ2h0JztcbmltcG9ydCB0eXBlIHsgSHlseXQgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5cbmZ1bmN0aW9uIGdldFRleHROb2RlKHBhcmVudFNlbGVjdG9yLCBpbmRleCkge1xuICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihwYXJlbnRTZWxlY3RvcikuY2hpbGROb2Rlc1tpbmRleF07XG59XG5cbmZ1bmN0aW9uIGdldEh5bHl0UmFuZ2UoaHlseXQpIHtcbiAgY29uc3QgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xuICBsZXQgc3RhcnROb2RlO1xuICBsZXQgZW5kTm9kZTtcbiAgaWYgKGh5bHl0LmVsZW1zKSB7XG4gICAgcmFuZ2Uuc2V0U3RhcnRCZWZvcmUoaHlseXQuZWxlbXNbMF0pO1xuICAgIHJhbmdlLnNldEVuZEFmdGVyKGh5bHl0LmVsZW1zW2h5bHl0LmVsZW1zLmxlbmd0aCAtIDFdKTtcbiAgfSBlbHNlIHtcbiAgICBzdGFydE5vZGUgPSBnZXRUZXh0Tm9kZShoeWx5dC5zdGFydFNlbGVjdG9yLCBoeWx5dC5zdGFydE5vZGVJbmRleCk7XG4gICAgZW5kTm9kZSA9IGdldFRleHROb2RlKGh5bHl0LmVuZFNlbGVjdG9yLCBoeWx5dC5lbmROb2RlSW5kZXgpO1xuICAgIHJhbmdlLnNldFN0YXJ0KHN0YXJ0Tm9kZSwgaHlseXQuc3RhcnRPZmZzZXQpO1xuICAgIHJhbmdlLnNldEVuZChlbmROb2RlLCBoeWx5dC5lbmRPZmZzZXQpO1xuICB9XG4gIHJldHVybiByYW5nZTtcbn1cblxuZnVuY3Rpb24gcGxhY2VJbmRpY2F0b3JzKGh5bHl0czogQXJyYXk8SHlseXQ+KSB7XG4gIGh5bHl0cy5mb3JFYWNoKChobCkgPT4gcGxhY2VTY3JvbGxJbmRpY2F0b3IoaGwpKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKGh5bHl0czogQXJyYXk8SHlseXQ+IHwgSHlseXQsIG9uQ2xpY2s/OiBGdW5jdGlvbikge1xuICBpZiAoIUFycmF5LmlzQXJyYXkoaHlseXRzKSkgaHlseXRzID0gW2h5bHl0c107XG4gIGh5bHl0cy5mb3JFYWNoKChoeWx5dDogSHlseXQpID0+IHtcbiAgICBjb25zdCByYW5nZSA9IGdldEh5bHl0UmFuZ2UoaHlseXQpO1xuICAgIGlmIChpc1ZhbGlkUmFuZ2UocmFuZ2UpKSB7XG4gICAgICBoeWx5dC5lbGVtcyA9IGNyZWF0ZUVsZW1zKHJhbmdlLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiBvbkNsaWNrICYmIG9uQ2xpY2soaHlseXQsIGV2dCkpO1xuICAgIH1cbiAgfSk7XG4gIGNvbnN0IGhhc2hTdGFydCA9ICcjaGktJztcbiAgaHlseXRzLmZvckVhY2goKGhsKSA9PiBhZGRTY3JvbGxJbmRpY2F0b3IoaGwsIG9uQ2xpY2spKTtcbiAgbGV0IGh5bHl0SWQ7XG4gIGlmICghbG9jYXRpb24uaGFzaC5pbmRleE9mKGhhc2hTdGFydCkpIHtcbiAgICBoeWx5dElkID0gcGFyc2VJbnQobG9jYXRpb24uaGFzaC5zdWJzdHIoaGFzaFN0YXJ0Lmxlbmd0aCkpO1xuICAgIGNvbnN0IGh5bHl0ID0gaHlseXRzLmZpbmQoKGhsKSA9PiBobC5pZCA9PT0gaHlseXRJZCk7XG4gICAgaWYgKGh5bHl0KSBzY3JvbGxUb0hpZ2hsaWdodChoeWx5dCk7XG4gIH1cbiAgLy8gY29uc3QgaW50ZXJ2YWxJZCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiBwbGFjZUluZGljYXRvcnMoaHlseXRzKSwgNTAwMCk7XG4gIHdpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XG4gICAgcGxhY2VJbmRpY2F0b3JzKGh5bHl0cyk7XG4gICAgLy8gd2luZG93LmNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XG4gIH07XG4gIHJldHVybiBoeWx5dElkO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3Jlc3RvcmUuanMiXSwic291cmNlUm9vdCI6IiJ9